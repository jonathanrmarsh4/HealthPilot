jonathanmarsh@Jonathans-MacBook-Air HealthPilot % grep "26 health data types" dist/public/assets/index-*.js
For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return x.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},__e="DialogDescriptionWarning",T_e=({contentRef:e,descriptionId:t})=>{const a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${kye(__e).contentName}}.`;return x.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(a))},[a,e,t]),null},tb=lye,rH=dye,rb=hye,Nf=pye,Sf=mye,R0=yye,$0=xye,nb=bye;const SX=tb,jye=rH,I_e=rb,Nye=x.forwardRef(({className:e,...t},r)=>n.jsx(Nf,{className:xe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Nye.displayName=Nf.displayName;const L_e=jf("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),nH=x.forwardRef(({side:e="right",className:t,children:r,...a},s)=>n.jsxs(I_e,{children:[n.jsx(Nye,{}),n.jsxs(Sf,{ref:s,className:xe(L_e({side:e}),t),...a,children:[r,n.jsxs(nb,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[n.jsx(ta,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));nH.displayName=Sf.displayName;const aH=({className:e,...t})=>n.jsx("div",{className:xe("flex flex-col space-y-2 text-center sm:text-left",e),...t});aH.displayName="SheetHeader";const sH=x.forwardRef(({className:e,...t},r)=>n.jsx(R0,{ref:r,className:xe("text-lg font-semibold text-foreground",e),...t}));sH.displayName=R0.displayName;const iH=x.forwardRef(({className:e,...t},r)=>n.jsx($0,{ref:r,className:xe("text-sm text-muted-foreground",e),...t}));iH.displayName=$0.displayName;function ze({className:e,...t}){return n.jsx("div",{className:xe("animate-pulse rounded-md bg-muted",e),...t})}const E_e="sidebar_state",O_e=60*60*24*7,D_e="16rem",R_e="18rem",$_e="3rem",F_e="b",Sye=x.createContext(null);function MX(){const e=x.useContext(Sye);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}function z_e({defaultOpen:e=!0,open:t,onOpenChange:r,className:a,style:s,children:i,...o}){const l=M7e(),[c,d]=x.useState(!1),[u,h]=x.useState(e),p=t??u,f=x.useCallback(b=>{const w=typeof b=="function"?b(p):b;r?r(w):h(w),document.cookie=`${E_e}=${w}; path=/; max-age=${O_e}`},[r,p]),y=x.useCallback(()=>l?d(b=>!b):f(b=>!b),[l,f,d]);x.useEffect(()=>{const b=w=>{w.key===F_e&&(w.metaKey||w.ctrlKey)&&(w.preventDefault(),y())};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[y]);const v=p?"expanded":"collapsed",m=x.useMemo(()=>({state:v,open:p,setOpen:f,isMobile:l,openMobile:c,setOpenMobile:d,toggleSidebar:y}),[v,p,f,l,c,d,y]);return n.jsx(Sye.Provider,{value:m,children:n.jsx(Rc,{delayDuration:0,children:n.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":D_e,"--sidebar-width-icon":$_e,...s},className:xe("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",a),...o,children:i})})})}function H_e({side:e="left",variant:t="sidebar",collapsible:r="offcanvas",className:a,children:s,...i}){const{isMobile:o,state:l,openMobile:c,setOpenMobile:d}=MX();return r==="none"?n.jsx("div",{"data-slot":"sidebar",className:xe("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",a),...i,children:s}):o?n.jsx(SX,{open:c,onOpenChange:d,...i,children:n.jsxs(nH,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden",style:{"--sidebar-width":R_e},side:e,children:[n.jsxs(aH,{className:"sr-only",children:[n.jsx(sH,{children:"Sidebar"}),n.jsx(iH,{children:"Displays the mobile sidebar."})]}),n.jsx("div",{className:"flex h-full w-full flex-col",children:s})]})}):n.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":l,"data-collapsible":l==="collapsed"?r:"","data-variant":t,"data-side":e,"data-slot":"sidebar",children:[n.jsx("div",{"data-slot":"sidebar-gap",className:xe("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]")}),n.jsx("div",{"data-slot":"sidebar-container",className:xe("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",a),...i,children:n.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:s})})]})}function B_e({className:e,onClick:t,...r}){const{toggleSidebar:a}=MX();return n.jsxs(z,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:xe("h-7 w-7",e),onClick:s=>{t==null||t(s),a()},...r,children:[n.jsx(gc,{}),n.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function q_e({className:e,...t}){return n.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:xe("flex flex-col gap-2 p-2",e),...t})}function V_e({className:e,...t}){return n.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:xe("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t})}function Oq({className:e,...t}){return n.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:xe("relative flex w-full min-w-0 flex-col p-2",e),...t})}function U_e({className:e,asChild:t=!1,...r}){const a=t?qz:"div";return n.jsx(a,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:xe("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...r})}function Dq({className:e,...t}){return n.jsx("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:xe("w-full text-sm",e),...t})}function Rq({className:e,...t}){return n.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:xe("flex w-full min-w-0 flex-col gap-1",e),...t})}function Sg({className:e,...t}){return n.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:xe("group/menu-item relative",e),...t})}const W_e=jf("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function Mg({asChild:e=!1,isActive:t=!1,variant:r="default",size:a="default",tooltip:s,className:i,...o}){const l=e?qz:"button",{isMobile:c,state:d}=MX(),u=n.jsx(l,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":a,"data-active":t,className:xe(W_e({variant:r,size:a}),i),...o});return s?(typeof s=="string"&&(s={children:s}),n.jsxs(xl,{children:[n.jsx(vl,{asChild:!0,children:u}),n.jsx(jo,{side:"right",align:"center",hidden:d!=="collapsed"||c,...s})]})):u}var CX="Collapsible",[K_e,Mye]=hn(CX),[G_e,AX]=K_e(CX),Cye=x.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:a,defaultOpen:s,disabled:i,onOpenChange:o,...l}=e,[c=!1,d]=ua({prop:a,defaultProp:s,onChange:o});return n.jsx(G_e,{scope:r,disabled:i,contentId:Cn(),open:c,onOpenToggle:x.useCallback(()=>d(u=>!u),[d]),children:n.jsx($e.div,{"data-state":IX(c),"data-disabled":i?"":void 0,...l,ref:t})})});Cye.displayName=CX;var Aye="CollapsibleTrigger",PX=x.forwardRef((e,t)=>{const{__scopeCollapsible:r,...a}=e,s=AX(Aye,r);return n.jsx($e.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":IX(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...a,ref:t,onClick:Ne(e.onClick,s.onOpenToggle)})});PX.displayName=Aye;var _X="CollapsibleContent",TX=x.forwardRef((e,t)=>{const{forceMount:r,...a}=e,s=AX(_X,e.__scopeCollapsible);return n.jsx(bn,{present:r||s.open,children:({present:i})=>n.jsx(Y_e,{...a,ref:t,present:i})})});TX.displayName=_X;var Y_e=x.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:a,children:s,...i}=e,o=AX(_X,r),[l,c]=x.useState(a),d=x.useRef(null),u=st(t,d),h=x.useRef(0),p=h.current,f=x.useRef(0),y=f.current,v=o.open||l,m=x.useRef(v),b=x.useRef(void 0);return x.useEffect(()=>{const w=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(w)},[]),ra(()=>{const w=d.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const k=w.getBoundingClientRect();h.current=k.height,f.current=k.width,m.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),c(a)}},[o.open,a]),n.jsx($e.div,{"data-state":IX(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...i,ref:u,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":y?`${y}px`:void 0,...e.style},children:v&&s})});function IX(e){return e?"open":"closed"}var Pye=Cye,X_e=PX,Z_e=TX;const Fm=Pye,zm=PX,Hm=TX;function oH(){const{data:e,isLoading:t}=we({queryKey:["/api/auth/user"],retry:!1});return{user:e,isLoading:t,isAuthenticated:!!e,isAdmin:(e==null?void 0:e.role)==="admin"}}const Vte={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var $q={};const Ute={BASELINE_MODE_ENABLED:{name:"BASELINE_MODE_ENABLED",default:!1,level:"site",description:"Master flag: enables deterministic catalog mode, disables all AI/ML features"},AI_MEAL_FILTERS_ENABLED:{name:"AI_MEAL_FILTERS_ENABLED",default:!1,level:"site",description:"Allow AI-powered meal filtering based on user context"},AI_MEAL_RANKING_ENABLED:{name:"AI_MEAL_RANKING_ENABLED",default:!1,level:"site",description:"Use AI to rank and sort meal recommendations"},MEAL_GOAL_FILTER_ENABLED:{name:"MEAL_GOAL_FILTER_ENABLED",default:!1,level:"site",description:"Filter meals based on user goals (weight loss, muscle gain, etc.)"},MEAL_PREFERENCE_WEIGHTING_ENABLED:{name:"MEAL_PREFERENCE_WEIGHTING_ENABLED",default:!1,level:"user",description:"Weight meal recommendations based on user like/dislike history"},BIOMARKER_FILTER_ENABLED:{name:"BIOMARKER_FILTER_ENABLED",default:!1,level:"site",description:"Filter meals and workouts based on biomarker data"},AI_WORKOUT_SELECTION_ENABLED:{name:"AI_WORKOUT_SELECTION_ENABLED",default:!1,level:"site",description:"Use AI to generate and customize workout plans"},DAILY_AI_TRAINING_GENERATOR_ENABLED:{name:"DAILY_AI_TRAINING_GENERATOR_ENABLED",default:!0,level:"site",description:"Enable AI-powered daily training session generator with standards-based workouts"},FEATURE_SHOW_SMARTFUEL:{name:"FEATURE_SHOW_SMARTFUEL",default:!0,level:"site",description:"Enable SmartFuel™ precision nutrition guidance system (biomarker-driven dietary advice)"},FEATURE_SHOW_RECIPE_FEATURES:{name:"FEATURE_SHOW_RECIPE_FEATURES",default:!1,level:"site",description:"Show legacy meal plan and recipe features (parked for future reactivation)"},NOTIFICATIONS_LAYER_ENABLED:{name:"NOTIFICATIONS_LAYER_ENABLED",default:!0,level:"site",description:"Master flag: enables entire notifications infrastructure (push, local, inbox)"},PUSH_NOTIFICATIONS_ENABLED:{name:"PUSH_NOTIFICATIONS_ENABLED",default:!0,level:"site",description:"Enable OneSignal push notifications for AI insights and alerts"},LOCAL_NOTIFICATIONS_ENABLED:{name:"LOCAL_NOTIFICATIONS_ENABLED",default:!0,level:"site",description:"Enable local scheduled notifications for supplement and workout reminders"},NOTIFICATION_INBOX_ENABLED:{name:"NOTIFICATION_INBOX_ENABLED",default:!0,level:"site",description:"Enable notification center/inbox UI for viewing notification history"}};function Q_e(e){if(typeof process<"u"&&$q&&$q[e]!==void 0)return $q[e];if(typeof import.meta<"u"&&Vte)return Vte[`VITE_${e}`]}function J_e(e,t){if(e===void 0||e==="")return t;const r=e.toLowerCase().trim();return r==="true"||r==="1"||r==="yes"}class eTe{constructor(){this.cache=new Map}isEnabled(t){if(this.cache.has(t))return this.cache.get(t);const r=Ute[t];if(!r)return console.warn(`[FeatureFlags] Unknown flag: ${t}`),!1;const a=Q_e(r.name),s=J_e(a,r.default);let i=s;return["BASELINE_MODE_ENABLED","NOTIFICATIONS_LAYER_ENABLED","PUSH_NOTIFICATIONS_ENABLED","LOCAL_NOTIFICATIONS_ENABLED","NOTIFICATION_INBOX_ENABLED"].includes(t)?i=s:this.isEnabled("BASELINE_MODE_ENABLED")&&(i=!1),this.cache.set(t,i),i}clearCache(){this.cache.clear()}getAllFlags(){const t={};for(const r of Object.keys(Ute))t[r]=this.isEnabled(r);return t}isBaselineMode(){return this.isEnabled("BASELINE_MODE_ENABLED")}}const LX=new eTe,tTe=()=>LX.isBaselineMode(),rTe=()=>LX.isEnabled("FEATURE_SHOW_SMARTFUEL"),Wte=()=>LX.isEnabled("FEATURE_SHOW_RECIPE_FEATURES"),ab="/assets/HealthPilot_Logo_1759904141260-vsk9EWYG.png",nTe=()=>{const e=[{title:"Training",url:"/training",icon:gr}];rTe()&&e.push({title:"SmartFuel™",url:"/smartfuel",icon:Ve}),Wte()&&e.push({title:"Nutrition",url:"/meals",icon:pl}),e.push({title:"Supplementation",url:"/supplements",icon:Cl});const t=[{title:"Health Records",url:"/records",icon:ci},{title:"Fitness Profile",url:"/training/fitness-profile",icon:$m}];return Wte()&&t.push({title:"Nutrition Profile",url:"/meals/nutrition-profile",icon:pl}),t.push({title:"Integrations",url:"/apple-health",icon:di},{title:"HealthKit Diagnostics",url:"/healthkit-diagnostics",icon:Fx},{title:"Privacy Policy",url:"/privacy",icon:ka},{title:"Privacy Dashboard",url:"/privacy-dashboard",icon:K1}),[{title:"About You",icon:yc,items:[{title:"Goals",url:"/goals",icon:dn},{title:"Biomarkers",url:"/biomarkers",icon:Pt},{title:"Sleep",url:"/sleep",icon:Ca},{title:"Symptoms",url:"/symptoms",icon:Wt},{title:"Longevity",url:"/biological-age",icon:Im}]},{title:"Your Plan",icon:gr,items:e},{title:"AI Coach",icon:Ve,items:[{title:"Chat",url:"/chat",icon:R1},{title:"Voice Chat",url:"/voice-chat",icon:Jc},{title:"Recommendations",url:"/insights",icon:Ve},{title:"Trends",url:"/data-insights",icon:bo}]},{title:"Settings & Data",icon:Oo,items:t}]},aTe=nTe();function sTe(){const[e]=_n(),{isAdmin:t}=oH();return n.jsxs(H_e,{children:[n.jsx(q_e,{className:"p-4 border-b border-sidebar-border",children:n.jsxs(_r,{href:"/",className:"flex items-center gap-3",children:[n.jsx("img",{src:ab,alt:"HealthPilot",className:"h-10 w-10 object-contain"}),n.jsx("span",{className:"text-lg font-semibold",children:"HealthPilot"})]})}),n.jsxs(V_e,{children:[n.jsx(Oq,{children:n.jsx(Dq,{children:n.jsxs(Rq,{children:[n.jsx(Sg,{children:n.jsx(Mg,{asChild:!0,isActive:e==="/","data-testid":"link-dashboard",children:n.jsxs(_r,{href:"/",children:[n.jsx(Px,{className:"h-4 w-4"}),n.jsx("span",{children:"Dashboard"})]})})}),n.jsx(Sg,{children:n.jsx(Mg,{asChild:!0,isActive:e==="/notifications","data-testid":"link-notifications",children:n.jsxs(_r,{href:"/notifications",children:[n.jsx(Nl,{className:"h-4 w-4"}),n.jsx("span",{children:"Notifications"})]})})}),t&&n.jsx(Sg,{children:n.jsx(Mg,{asChild:!0,isActive:e.startsWith("/admin"),"data-testid":"link-admin-panel",children:n.jsxs(_r,{href:"/admin",children:[n.jsx(br,{className:"h-4 w-4"}),n.jsx("span",{children:"Admin Panel"})]})})})]})})}),aTe.map(r=>r.adminOnly&&!t?null:n.jsx(Fm,{defaultOpen:!1,className:"group/collapsible",children:n.jsxs(Oq,{children:[n.jsx(U_e,{asChild:!0,children:n.jsxs(zm,{className:"flex w-full items-center gap-2 hover-elevate active-elevate-2 rounded-md px-2 py-1.5",children:[n.jsx(r.icon,{className:"h-4 w-4"}),n.jsx("span",{className:"flex-1 text-left",children:r.title}),n.jsx(Ma,{className:"h-4 w-4 transition-transform group-data-[state=open]/collapsible:rotate-90"})]})}),n.jsx(Hm,{children:n.jsx(Dq,{children:n.jsx(Rq,{children:r.items.map(a=>n.jsx(Sg,{children:n.jsx(Mg,{asChild:!a.badge,isActive:e===a.url,disabled:!!a.badge,"data-testid":`link-${a.title.toLowerCase().replace(/\s+/g,"-")}`,children:a.badge?n.jsxs("span",{className:"pl-6 cursor-not-allowed","aria-disabled":"true",children:[n.jsx(a.icon,{className:"h-4 w-4"}),n.jsx("span",{children:a.title}),n.jsx("span",{className:"ml-auto text-xs text-muted-foreground",children:a.badge})]}):n.jsxs(_r,{href:a.url,className:"pl-6",children:[n.jsx(a.icon,{className:"h-4 w-4"}),n.jsx("span",{children:a.title})]})})},a.title))})})})]})},r.title)),n.jsx(Oq,{className:"mt-auto",children:n.jsx(Dq,{children:n.jsx(Rq,{children:n.jsx(Sg,{children:n.jsx(Mg,{asChild:!0,isActive:e==="/profile","data-testid":"link-profile",children:n.jsxs(_r,{href:"/profile",children:[n.jsx($m,{className:"h-4 w-4"}),n.jsx("span",{children:"Profile"})]})})})})})})]})]})}const _ye=x.createContext(void 0),Kte="v2-dark-default";function iTe({children:e,defaultTheme:t="dark"}){const[r,a]=x.useState(()=>localStorage.getItem("theme-version")!==Kte?(localStorage.removeItem("theme"),localStorage.setItem("theme-version",Kte),t):localStorage.getItem("theme")||t);return x.useEffect(()=>{const s=document.documentElement;s.classList.remove("light","dark"),s.classList.add(r),localStorage.setItem("theme",r)},[r]),n.jsx(_ye.Provider,{value:{theme:r,setTheme:a},children:e})}function oTe(){const e=x.useContext(_ye);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e}function lTe(){const{theme:e,setTheme:t}=oTe();return n.jsxs(z,{variant:"ghost",size:"icon",onClick:()=>t(e==="light"?"dark":"light"),"data-testid":"button-theme-toggle",children:[e==="light"?n.jsx(Ca,{className:"h-5 w-5"}):n.jsx(G1,{className:"h-5 w-5"}),n.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}const Tye=x.createContext(void 0);function cTe(){const e=navigator.language||"en-US";return e.startsWith("en-US")||e.startsWith("en-LR")||e.startsWith("en-MM")?"imperial":"metric"}function dTe(){const e=navigator.language,t=["en-US","en-GB","en-CA","en-AU","es-ES","fr-FR","de-DE","it-IT","ja-JP","zh-CN"],r=t.find(s=>s===e);if(r)return r;const a=t.find(s=>s.startsWith(e.split("-")[0]));return a||"en-US"}function uTe({children:e}){const[t,r]=x.useState(()=>localStorage.getItem("unitSystem")||cTe()),[a,s]=x.useState(()=>localStorage.getItem("locale")||dTe());x.useEffect(()=>{localStorage.setItem("unitSystem",t)},[t]),x.useEffect(()=>{localStorage.setItem("locale",a)},[a]);const i=l=>{r(l)},o=l=>{s(l)};return n.jsx(Tye.Provider,{value:{unitSystem:t,locale:a,setUnitSystem:i,setLocale:o},children:e})}function F0(){const e=x.useContext(Tye);if(!e)throw new Error("useLocale must be used within a LocaleProvider");return e}var hTe=x.createContext(void 0);function jd(e){const t=x.useContext(hTe);return e||t||"ltr"}var Fq="rovingFocusGroup.onEntryFocus",pTe={bubbles:!1,cancelable:!0},lH="RovingFocusGroup",[PW,Iye,mTe]=T0(lH),[fTe,z0]=hn(lH,[mTe]),[yTe,gTe]=fTe(lH),Lye=x.forwardRef((e,t)=>n.jsx(PW.Provider,{scope:e.__scopeRovingFocusGroup,children:n.jsx(PW.Slot,{scope:e.__scopeRovingFocusGroup,children:n.jsx(xTe,{...e,ref:t})})}));Lye.displayName=lH;var xTe=x.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:a,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...h}=e,p=x.useRef(null),f=st(t,p),y=jd(i),[v=null,m]=ua({prop:o,defaultProp:l,onChange:c}),[b,w]=x.useState(!1),k=Ur(d),N=Iye(r),j=x.useRef(!1),[M,S]=x.useState(0);return x.useEffect(()=>{const C=p.current;if(C)return C.addEventListener(Fq,k),()=>C.removeEventListener(Fq,k)},[k]),n.jsx(yTe,{scope:r,orientation:a,dir:y,loop:s,currentTabStopId:v,onItemFocus:x.useCallback(C=>m(C),[m]),onItemShiftTab:x.useCallback(()=>w(!0),[]),onFocusableItemAdd:x.useCallback(()=>S(C=>C+1),[]),onFocusableItemRemove:x.useCallback(()=>S(C=>C-1),[]),children:n.jsx($e.div,{tabIndex:b||M===0?-1:0,"data-orientation":a,...h,ref:f,style:{outline:"none",...e.style},onMouseDown:Ne(e.onMouseDown,()=>{j.current=!0}),onFocus:Ne(e.onFocus,C=>{const A=!j.current;if(C.target===C.currentTarget&&A&&!b){const I=new CustomEvent(Fq,pTe);if(C.currentTarget.dispatchEvent(I),!I.defaultPrevented){const P=N().filter(_=>_.focusable),L=P.find(_=>_.active),E=P.find(_=>_.id===v),q=[L,E,...P].filter(Boolean).map(_=>_.ref.current);Dye(q,u)}}j.current=!1}),onBlur:Ne(e.onBlur,()=>w(!1))})})}),Eye="RovingFocusGroupItem",Oye=x.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:a=!0,active:s=!1,tabStopId:i,...o}=e,l=Cn(),c=i||l,d=gTe(Eye,r),u=d.currentTabStopId===c,h=Iye(r),{onFocusableItemAdd:p,onFocusableItemRemove:f}=d;return x.useEffect(()=>{if(a)return p(),()=>f()},[a,p,f]),n.jsx(PW.ItemSlot,{scope:r,id:c,focusable:a,active:s,children:n.jsx($e.span,{tabIndex:u?0:-1,"data-orientation":d.orientation,...o,ref:t,onMouseDown:Ne(e.onMouseDown,y=>{a?d.onItemFocus(c):y.preventDefault()}),onFocus:Ne(e.onFocus,()=>d.onItemFocus(c)),onKeyDown:Ne(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){d.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const v=wTe(y,d.orientation,d.dir);if(v!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let b=h().filter(w=>w.focusable).map(w=>w.ref.current);if(v==="last")b.reverse();else if(v==="prev"||v==="next"){v==="prev"&&b.reverse();const w=b.indexOf(y.currentTarget);b=d.loop?kTe(b,w+1):b.slice(w+1)}setTimeout(()=>Dye(b))}})})})});Oye.displayName=Eye;var vTe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function bTe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function wTe(e,t,r){const a=bTe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return vTe[a]}function Dye(e,t=!1){const r=document.activeElement;for(const a of e)if(a===r||(a.focus({preventScroll:t}),document.activeElement!==r))return}function kTe(e,t){return e.map((r,a)=>e[(t+a)%e.length])}var EX=Lye,OX=Oye,_W=["Enter"," "],jTe=["ArrowDown","PageUp","Home"],Rye=["ArrowUp","PageDown","End"],NTe=[...jTe,...Rye],STe={ltr:[..._W,"ArrowRight"],rtl:[..._W,"ArrowLeft"]},MTe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},sb="Menu",[L2,CTe,ATe]=T0(sb),[Mf,$ye]=hn(sb,[ATe,Zo,z0]),cH=Zo(),Fye=z0(),[PTe,Cf]=Mf(sb),[_Te,ib]=Mf(sb),zye=e=>{const{__scopeMenu:t,open:r=!1,children:a,dir:s,onOpenChange:i,modal:o=!0}=e,l=cH(t),[c,d]=x.useState(null),u=x.useRef(!1),h=Ur(i),p=jd(s);return x.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),n.jsx(Xv,{...l,children:n.jsx(PTe,{scope:t,open:r,onOpenChange:h,content:c,onContentChange:d,children:n.jsx(_Te,{scope:t,onClose:x.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:p,modal:o,children:a})})})};zye.displayName=sb;var TTe="MenuAnchor",DX=x.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e,s=cH(r);return n.jsx(D0,{...s,...a,ref:t})});DX.displayName=TTe;var RX="MenuPortal",[ITe,Hye]=Mf(RX,{forceMount:void 0}),Bye=e=>{const{__scopeMenu:t,forceMount:r,children:a,container:s}=e,i=Cf(RX,t);return n.jsx(ITe,{scope:t,forceMount:r,children:n.jsx(bn,{present:r||i.open,children:n.jsx(I0,{asChild:!0,container:s,children:a})})})};Bye.displayName=RX;var ui="MenuContent",[LTe,$X]=Mf(ui),qye=x.forwardRef((e,t)=>{const r=Hye(ui,e.__scopeMenu),{forceMount:a=r.forceMount,...s}=e,i=Cf(ui,e.__scopeMenu),o=ib(ui,e.__scopeMenu);return n.jsx(L2.Provider,{scope:e.__scopeMenu,children:n.jsx(bn,{present:a||i.open,children:n.jsx(L2.Slot,{scope:e.__scopeMenu,children:o.modal?n.jsx(ETe,{...s,ref:t}):n.jsx(OTe,{...s,ref:t})})})})}),ETe=x.forwardRef((e,t)=>{const r=Cf(ui,e.__scopeMenu),a=x.useRef(null),s=st(t,a);return x.useEffect(()=>{const i=a.current;if(i)return tH(i)},[]),n.jsx(FX,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Ne(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),OTe=x.forwardRef((e,t)=>{const r=Cf(ui,e.__scopeMenu);return n.jsx(FX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),DTe=od("MenuContent.ScrollLock"),FX=x.forwardRef((e,t)=>{const{__scopeMenu:r,loop:a=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:p,onDismiss:f,disableOutsideScroll:y,...v}=e,m=Cf(ui,r),b=ib(ui,r),w=cH(r),k=Fye(r),N=CTe(r),[j,M]=x.useState(null),S=x.useRef(null),C=st(t,S,m.onContentChange),A=x.useRef(0),I=x.useRef(""),P=x.useRef(0),L=x.useRef(null),E=x.useRef("right"),R=x.useRef(0),q=y?eb:x.Fragment,_=y?{as:DTe,allowPinchZoom:!0}:void 0,D=F=>{var se,Me;const ee=I.current+F,oe=N().filter(ce=>!ce.disabled),K=document.activeElement,ne=(se=oe.find(ce=>ce.ref.current===K))==null?void 0:se.textValue,me=oe.map(ce=>ce.textValue),ue=GTe(me,ee,ne),W=(Me=oe.find(ce=>ce.textValue===ue))==null?void 0:Me.ref.current;(function ce(U){I.current=U,window.clearTimeout(A.current),U!==""&&(A.current=window.setTimeout(()=>ce(""),1e3))})(ee),W&&setTimeout(()=>W.focus())};x.useEffect(()=>()=>window.clearTimeout(A.current),[]),Jz();const T=x.useCallback(F=>{var oe,K;return E.current===((oe=L.current)==null?void 0:oe.side)&&XTe(F,(K=L.current)==null?void 0:K.area)},[]);return n.jsx(LTe,{scope:r,searchRef:I,onItemEnter:x.useCallback(F=>{T(F)&&F.preventDefault()},[T]),onItemLeave:x.useCallback(F=>{var ee;T(F)||((ee=S.current)==null||ee.focus(),M(null))},[T]),onTriggerLeave:x.useCallback(F=>{T(F)&&F.preventDefault()},[T]),pointerGraceTimerRef:P,onPointerGraceIntentChange:x.useCallback(F=>{L.current=F},[]),children:n.jsx(q,{..._,children:n.jsx(Jv,{asChild:!0,trapped:s,onMountAutoFocus:Ne(i,F=>{var ee;F.preventDefault(),(ee=S.current)==null||ee.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:n.jsx(kd,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:p,onDismiss:f,children:n.jsx(EX,{asChild:!0,...k,dir:b.dir,orientation:"vertical",loop:a,currentTabStopId:j,onCurrentTabStopIdChange:M,onEntryFocus:Ne(c,F=>{b.isUsingKeyboardRef.current||F.preventDefault()}),preventScrollOnEntryFocus:!0,children:n.jsx(Zv,{role:"menu","aria-orientation":"vertical","data-state":s0e(m.open),"data-radix-menu-content":"",dir:b.dir,...w,...v,ref:C,style:{outline:"none",...v.style},onKeyDown:Ne(v.onKeyDown,F=>{const oe=F.target.closest("[data-radix-menu-content]")===F.currentTarget,K=F.ctrlKey||F.altKey||F.metaKey,ne=F.key.length===1;oe&&(F.key==="Tab"&&F.preventDefault(),!K&&ne&&D(F.key));const me=S.current;if(F.target!==me||!NTe.includes(F.key))return;F.preventDefault();const W=N().filter(se=>!se.disabled).map(se=>se.ref.current);Rye.includes(F.key)&&W.reverse(),WTe(W)}),onBlur:Ne(e.onBlur,F=>{F.currentTarget.contains(F.target)||(window.clearTimeout(A.current),I.current="")}),onPointerMove:Ne(e.onPointerMove,E2(F=>{const ee=F.target,oe=R.current!==F.clientX;if(F.currentTarget.contains(ee)&&oe){const K=F.clientX>R.current?"right":"left";E.current=K,R.current=F.clientX}}))})})})})})})});qye.displayName=ui;var RTe="MenuGroup",zX=x.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e;return n.jsx($e.div,{role:"group",...a,ref:t})});zX.displayName=RTe;var $Te="MenuLabel",Vye=x.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e;return n.jsx($e.div,{...a,ref:t})});Vye.displayName=$Te;var H$="MenuItem",Gte="menu.itemSelect",dH=x.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:a,...s}=e,i=x.useRef(null),o=ib(H$,e.__scopeMenu),l=$X(H$,e.__scopeMenu),c=st(t,i),d=x.useRef(!1),u=()=>{const h=i.current;if(!r&&h){const p=new CustomEvent(Gte,{bubbles:!0,cancelable:!0});h.addEventListener(Gte,f=>a==null?void 0:a(f),{once:!0}),sX(h,p),p.defaultPrevented?d.current=!1:o.onClose()}};return n.jsx(Uye,{...s,ref:c,disabled:r,onClick:Ne(e.onClick,u),onPointerDown:h=>{var p;(p=e.onPointerDown)==null||p.call(e,h),d.current=!0},onPointerUp:Ne(e.onPointerUp,h=>{var p;d.current||(p=h.currentTarget)==null||p.click()}),onKeyDown:Ne(e.onKeyDown,h=>{const p=l.searchRef.current!=="";r||p&&h.key===" "||_W.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});dH.displayName=H$;var Uye=x.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:a=!1,textValue:s,...i}=e,o=$X(H$,r),l=Fye(r),c=x.useRef(null),d=st(t,c),[u,h]=x.useState(!1),[p,f]=x.useState("");return x.useEffect(()=>{const y=c.current;y&&f((y.textContent??"").trim())},[i.children]),n.jsx(L2.ItemSlot,{scope:r,disabled:a,textValue:s??p,children:n.jsx(OX,{asChild:!0,...l,focusable:!a,children:n.jsx($e.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":a||void 0,"data-disabled":a?"":void 0,...i,ref:d,onPointerMove:Ne(e.onPointerMove,E2(y=>{a?o.onItemLeave(y):(o.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ne(e.onPointerLeave,E2(y=>o.onItemLeave(y))),onFocus:Ne(e.onFocus,()=>h(!0)),onBlur:Ne(e.onBlur,()=>h(!1))})})})}),FTe="MenuCheckboxItem",Wye=x.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:a,...s}=e;return n.jsx(Zye,{scope:e.__scopeMenu,checked:r,children:n.jsx(dH,{role:"menuitemcheckbox","aria-checked":B$(r)?"mixed":r,...s,ref:t,"data-state":BX(r),onSelect:Ne(s.onSelect,()=>a==null?void 0:a(B$(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Wye.displayName=FTe;var Kye="MenuRadioGroup",[zTe,HTe]=Mf(Kye,{value:void 0,onValueChange:()=>{}}),Gye=x.forwardRef((e,t)=>{const{value:r,onValueChange:a,...s}=e,i=Ur(a);return n.jsx(zTe,{scope:e.__scopeMenu,value:r,onValueChange:i,children:n.jsx(zX,{...s,ref:t})})});Gye.displayName=Kye;var Yye="MenuRadioItem",Xye=x.forwardRef((e,t)=>{const{value:r,...a}=e,s=HTe(Yye,e.__scopeMenu),i=r===s.value;return n.jsx(Zye,{scope:e.__scopeMenu,checked:i,children:n.jsx(dH,{role:"menuitemradio","aria-checked":i,...a,ref:t,"data-state":BX(i),onSelect:Ne(a.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,r)},{checkForDefaultPrevented:!1})})})});Xye.displayName=Yye;var HX="MenuItemIndicator",[Zye,BTe]=Mf(HX,{checked:!1}),Qye=x.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:a,...s}=e,i=BTe(HX,r);return n.jsx(bn,{present:a||B$(i.checked)||i.checked===!0,children:n.jsx($e.span,{...s,ref:t,"data-state":BX(i.checked)})})});Qye.displayName=HX;var qTe="MenuSeparator",Jye=x.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e;return n.jsx($e.div,{role:"separator","aria-orientation":"horizontal",...a,ref:t})});Jye.displayName=qTe;var VTe="MenuArrow",e0e=x.forwardRef((e,t)=>{const{__scopeMenu:r,...a}=e,s=cH(r);return n.jsx(Qv,{...s,...a,ref:t})});e0e.displayName=VTe;var UTe="MenuSub",[T4t,t0e]=Mf(UTe),Zg="MenuSubTrigger",r0e=x.forwardRef((e,t)=>{const r=Cf(Zg,e.__scopeMenu),a=ib(Zg,e.__scopeMenu),s=t0e(Zg,e.__scopeMenu),i=$X(Zg,e.__scopeMenu),o=x.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,d={__scopeMenu:e.__scopeMenu},u=x.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return x.useEffect(()=>u,[u]),x.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),n.jsx(DX,{asChild:!0,...d,children:n.jsx(Uye,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":s0e(r.open),...e,ref:zl(t,s.onTriggerChange),onClick:h=>{var p;(p=e.onClick)==null||p.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Ne(e.onPointerMove,E2(h=>{i.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:Ne(e.onPointerLeave,E2(h=>{var f,y;u();const p=(f=r.content)==null?void 0:f.getBoundingClientRect();if(p){const v=(y=r.content)==null?void 0:y.dataset.side,m=v==="right",b=m?-5:5,w=p[m?"left":"right"],k=p[m?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+b,y:h.clientY},{x:w,y:p.top},{x:k,y:p.top},{x:k,y:p.bottom},{x:w,y:p.bottom}],side:v}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Ne(e.onKeyDown,h=>{var f;const p=i.searchRef.current!=="";e.disabled||p&&h.key===" "||STe[a.dir].includes(h.key)&&(r.onOpenChange(!0),(f=r.content)==null||f.focus(),h.preventDefault())})})})});r0e.displayName=Zg;var n0e="MenuSubContent",a0e=x.forwardRef((e,t)=>{const r=Hye(ui,e.__scopeMenu),{forceMount:a=r.forceMount,...s}=e,i=Cf(ui,e.__scopeMenu),o=ib(ui,e.__scopeMenu),l=t0e(n0e,e.__scopeMenu),c=x.useRef(null),d=st(t,c);return n.jsx(L2.Provider,{scope:e.__scopeMenu,children:n.jsx(bn,{present:a||i.open,children:n.jsx(L2.Slot,{scope:e.__scopeMenu,children:n.jsx(FX,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Ne(e.onFocusOutside,u=>{u.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Ne(e.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:Ne(e.onKeyDown,u=>{var f;const h=u.currentTarget.contains(u.target),p=MTe[o.dir].includes(u.key);h&&p&&(i.onOpenChange(!1),(f=l.trigger)==null||f.focus(),u.preventDefault())})})})})})});a0e.displayName=n0e;function s0e(e){return e?"open":"closed"}function B$(e){return e==="indeterminate"}function BX(e){return B$(e)?"indeterminate":e?"checked":"unchecked"}function WTe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function KTe(e,t){return e.map((r,a)=>e[(t+a)%e.length])}function GTe(e,t,r){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=KTe(e,Math.max(i,0));s.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function YTe(e,t){const{x:r,y:a}=e;let s=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i].x,c=t[i].y,d=t[o].x,u=t[o].y;c>a!=u>a&&r<(d-l)*(a-c)/(u-c)+l&&(s=!s)}return s}function XTe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return YTe(r,t)}function E2(e){return t=>t.pointerType==="mouse"?e(t):void 0}var ZTe=zye,QTe=DX,JTe=Bye,eIe=qye,tIe=zX,rIe=Vye,nIe=dH,aIe=Wye,sIe=Gye,iIe=Xye,oIe=Qye,lIe=Jye,cIe=e0e,dIe=r0e,uIe=a0e,qX="DropdownMenu",[hIe,I4t]=hn(qX,[$ye]),Xa=$ye(),[pIe,i0e]=hIe(qX),o0e=e=>{const{__scopeDropdownMenu:t,children:r,dir:a,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,c=Xa(t),d=x.useRef(null),[u=!1,h]=ua({prop:s,defaultProp:i,onChange:o});return n.jsx(pIe,{scope:t,triggerId:Cn(),triggerRef:d,contentId:Cn(),open:u,onOpenChange:h,onOpenToggle:x.useCallback(()=>h(p=>!p),[h]),modal:l,children:n.jsx(ZTe,{...c,open:u,onOpenChange:h,dir:a,modal:l,children:r})})};o0e.displayName=qX;var l0e="DropdownMenuTrigger",c0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:a=!1,...s}=e,i=i0e(l0e,r),o=Xa(r);return n.jsx(QTe,{asChild:!0,...o,children:n.jsx($e.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":a?"":void 0,disabled:a,...s,ref:zl(t,i.triggerRef),onPointerDown:Ne(e.onPointerDown,l=>{!a&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:Ne(e.onKeyDown,l=>{a||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});c0e.displayName=l0e;var mIe="DropdownMenuPortal",d0e=e=>{const{__scopeDropdownMenu:t,...r}=e,a=Xa(t);return n.jsx(JTe,{...a,...r})};d0e.displayName=mIe;var u0e="DropdownMenuContent",h0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=i0e(u0e,r),i=Xa(r),o=x.useRef(!1);return n.jsx(eIe,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...a,ref:t,onCloseAutoFocus:Ne(e.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:Ne(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!s.modal||u)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});h0e.displayName=u0e;var fIe="DropdownMenuGroup",yIe=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(tIe,{...s,...a,ref:t})});yIe.displayName=fIe;var gIe="DropdownMenuLabel",p0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(rIe,{...s,...a,ref:t})});p0e.displayName=gIe;var xIe="DropdownMenuItem",m0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(nIe,{...s,...a,ref:t})});m0e.displayName=xIe;var vIe="DropdownMenuCheckboxItem",f0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(aIe,{...s,...a,ref:t})});f0e.displayName=vIe;var bIe="DropdownMenuRadioGroup",y0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(sIe,{...s,...a,ref:t})});y0e.displayName=bIe;var wIe="DropdownMenuRadioItem",g0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(iIe,{...s,...a,ref:t})});g0e.displayName=wIe;var kIe="DropdownMenuItemIndicator",x0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(oIe,{...s,...a,ref:t})});x0e.displayName=kIe;var jIe="DropdownMenuSeparator",v0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(lIe,{...s,...a,ref:t})});v0e.displayName=jIe;var NIe="DropdownMenuArrow",SIe=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(cIe,{...s,...a,ref:t})});SIe.displayName=NIe;var MIe="DropdownMenuSubTrigger",b0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(dIe,{...s,...a,ref:t})});b0e.displayName=MIe;var CIe="DropdownMenuSubContent",w0e=x.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...a}=e,s=Xa(r);return n.jsx(uIe,{...s,...a,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});w0e.displayName=CIe;var AIe=o0e,PIe=c0e,_Ie=d0e,k0e=h0e,j0e=p0e,N0e=m0e,S0e=f0e,TIe=y0e,M0e=g0e,C0e=x0e,A0e=v0e,P0e=b0e,_0e=w0e;const IIe=AIe,LIe=PIe,EIe=TIe,OIe=x.forwardRef(({className:e,inset:t,children:r,...a},s)=>n.jsxs(P0e,{ref:s,className:xe("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...a,children:[r,n.jsx(Ma,{className:"ml-auto"})]}));OIe.displayName=P0e.displayName;const DIe=x.forwardRef(({className:e,...t},r)=>n.jsx(_0e,{ref:r,className:xe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...t}));DIe.displayName=_0e.displayName;const T0e=x.forwardRef(({className:e,sideOffset:t=4,...r},a)=>n.jsx(_Ie,{children:n.jsx(k0e,{ref:a,sideOffset:t,className:xe("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...r})}));T0e.displayName=k0e.displayName;const RIe=x.forwardRef(({className:e,inset:t,...r},a)=>n.jsx(N0e,{ref:a,className:xe("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...r}));RIe.displayName=N0e.displayName;const $Ie=x.forwardRef(({className:e,children:t,checked:r,...a},s)=>n.jsxs(S0e,{ref:s,className:xe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...a,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(C0e,{children:n.jsx(fr,{className:"h-4 w-4"})})}),t]}));$Ie.displayName=S0e.displayName;const TW=x.forwardRef(({className:e,children:t,...r},a)=>n.jsxs(M0e,{ref:a,className:xe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(C0e,{children:n.jsx(Xc,{className:"h-2 w-2 fill-current"})})}),t]}));TW.displayName=M0e.displayName;const I0e=x.forwardRef(({className:e,inset:t,...r},a)=>n.jsx(j0e,{ref:a,className:xe("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));I0e.displayName=j0e.displayName;const L0e=x.forwardRef(({className:e,...t},r)=>n.jsx(A0e,{ref:r,className:xe("-mx-1 my-1 h-px bg-muted",e),...t}));L0e.displayName=A0e.displayName;function FIe(){const{unitSystem:e,setUnitSystem:t}=F0();return n.jsxs(IIe,{children:[n.jsx(LIe,{asChild:!0,children:n.jsx(z,{variant:"ghost",size:"icon","data-testid":"button-locale-selector",children:n.jsx(E1,{className:"h-5 w-5"})})}),n.jsxs(T0e,{align:"end",children:[n.jsx(I0e,{children:"Unit System"}),n.jsx(L0e,{}),n.jsxs(EIe,{value:e,onValueChange:r=>t(r),children:[n.jsx(TW,{value:"metric","data-testid":"option-metric",children:"Metric (kg, cm, °C)"}),n.jsx(TW,{value:"imperial","data-testid":"option-imperial",children:"Imperial (lbs, in, °F)"})]})]})]})}const zIe=jf("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function Q({className:e,variant:t,...r}){return n.jsx("div",{className:xe(zIe({variant:t}),e),...r})}function E0e(){const{data:e,isLoading:t}=we({queryKey:["/api/notifications"]}),a=((e==null?void 0:e.notifications)||[]).map(c=>{var d;return{...c,read:c.readAt!==null,priority:((d=c.payload)==null?void 0:d.priority)||"medium"}}),s=a.filter(c=>!c.read).length,i=Se({mutationFn:async c=>await pe("POST",`/api/notifications/${c}/read`),onSuccess:()=>{le.invalidateQueries({queryKey:["/api/notifications"]})}}),o=Se({mutationFn:async()=>await pe("POST","/api/notifications/read-all"),onSuccess:()=>{le.invalidateQueries({queryKey:["/api/notifications"]})}}),l=Se({mutationFn:async c=>await pe("DELETE",`/api/notifications/${c}`),onSuccess:()=>{le.invalidateQueries({queryKey:["/api/notifications"]})}});return{notifications:a,isLoading:t,unreadCount:s,markAsRead:c=>i.mutate(c),markAllAsRead:()=>o.mutate(),dismiss:c=>l.mutate(c)}}function HIe(){const[,e]=_n(),{unreadCount:t}=E0e();return n.jsx("div",{className:"relative",children:n.jsxs(z,{variant:"ghost",size:"icon",onClick:()=>e("/notifications"),"data-testid":"button-notifications",className:"relative",children:[n.jsx(Nl,{className:"h-5 w-5"}),t>0&&n.jsx(Q,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 min-w-5 flex items-center justify-center p-0 text-xs","data-testid":"badge-unread-count",children:t>99?"99+":t})]})})}const O0e=x.createContext(void 0);function BIe({children:e}){const[t,r]=x.useState("UTC"),[a,s]=x.useState(!0);x.useEffect(()=>{(async()=>{try{const l=await pe("/api/user/settings");if(l.ok){const c=await l.json();c.timezone&&r(c.timezone)}}catch(l){console.error("Failed to fetch timezone:",l)}finally{s(!1)}})()},[]);const i=o=>{r(o)};return n.jsx(O0e.Provider,{value:{timezone:t,setTimezone:i,isLoading:a},children:e})}function ob(){const e=x.useContext(O0e);if(e===void 0)throw new Error("useTimezone must be used within a TimezoneProvider");return e}const D0e=x.createContext(void 0);function qIe({children:e}){const{data:t,isLoading:r}=we({queryKey:["/api/onboarding/status"]}),a=!!(t&&!t.basicInfoComplete);return n.jsx(D0e.Provider,{value:{status:t??null,isLoading:r,shouldShowOnboarding:a},children:e})}function R0e(){const e=x.useContext(D0e);if(e===void 0)throw new Error("useOnboarding must be used within an OnboardingProvider");return e}const $0e=x.createContext(void 0);function VIe({children:e}){const[t,r]=x.useState(!1),[a,s]=x.useState(!1),[i,o]=x.useState(null),l=d=>{d&&o(d),r(!0)},c=d=>{d&&o(d),s(!0)};return n.jsx($0e.Provider,{value:{openChat:l,openVoiceChat:c,isChatOpen:t,isVoiceChatOpen:a,setIsChatOpen:r,setIsVoiceChatOpen:s,chatContext:i},children:e})}function F0e(){const e=x.useContext($0e);if(e===void 0)throw new Error("useChat must be used within a ChatProvider");return e}const H=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:xe("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",e),...t}));H.displayName="Card";const G=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:xe("flex flex-col space-y-1.5 p-6",e),...t}));G.displayName="CardHeader";const Y=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:xe("text-2xl font-semibold leading-none tracking-tight",e),...t}));Y.displayName="CardTitle";const je=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:xe("text-sm text-muted-foreground",e),...t}));je.displayName="CardDescription";const B=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:xe("p-6 pt-0",e),...t}));B.displayName="CardContent";const VX=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:xe("flex items-center p-6 pt-0",e),...t}));VX.displayName="CardFooter";class UIe extends x.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,r){console.error("ErrorBoundary caught error:",t,r),this.setState({error:t,errorInfo:(r==null?void 0:r.componentStack)||JSON.stringify(r)})}render(){var t,r;return this.state.hasError?n.jsx("div",{className:"min-h-screen w-full flex items-center justify-center p-4 bg-background",children:n.jsxs(H,{className:"w-full max-w-2xl",children:[n.jsxs(G,{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Tr,{className:"h-6 w-6 text-destructive"}),n.jsx(Y,{children:"Something Went Wrong"})]}),n.jsx(je,{children:"The application encountered an error. Details below:"})]}),n.jsxs(B,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"Error Message:"}),n.jsx("pre",{className:"bg-muted p-3 rounded text-sm overflow-auto",children:((t=this.state.error)==null?void 0:t.toString())||"Unknown error"})]}),this.state.errorInfo&&n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"Component Stack:"}),n.jsx("pre",{className:"bg-muted p-3 rounded text-xs overflow-auto max-h-64",children:this.state.errorInfo})]}),((r=this.state.error)==null?void 0:r.stack)&&n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"Stack Trace:"}),n.jsx("pre",{className:"bg-muted p-3 rounded text-xs overflow-auto max-h-64",children:this.state.error.stack})]})]}),n.jsxs(VX,{className:"gap-2",children:[n.jsx(z,{onClick:()=>window.location.reload(),"data-testid":"button-reload",children:"Reload Page"}),n.jsx(z,{variant:"outline",onClick:()=>{localStorage.clear(),window.location.reload()},"data-testid":"button-clear-cache",children:"Clear Cache & Reload"})]})]})}):this.props.children}}function WIe({messageId:e,conversationType:t="text",onFeedbackGiven:r}){const{toast:a}=rt(),[s,i]=x.useState(null),o=Se({mutationFn:async c=>(await pe("POST","/api/chat/feedback",{messageId:e,feedbackType:c,context:{conversationType:t,timestamp:new Date().toISOString()}})).json(),onSuccess:(c,d)=>{i(d),a({title:"Thanks for your feedback!",description:d==="positive"?"We're glad the response was helpful.":"We'll use this to improve future responses."}),r==null||r()},onError:c=>{a({title:"Error",description:c.message||"Failed to submit feedback",variant:"destructive"})}}),l=c=>{s||o.isPending||o.mutate(c)};return n.jsxs("div",{className:"flex items-center gap-1","data-testid":"chat-feedback",children:[n.jsx(z,{size:"icon",variant:"ghost",onClick:()=>l("positive"),disabled:s!==null||o.isPending,className:`h-6 w-6 ${s==="positive"?"bg-green-500/20 text-green-600 dark:text-green-400":"text-muted-foreground hover:text-green-600 dark:hover:text-green-400"}`,"data-testid":"button-feedback-positive",title:"Helpful response",children:n.jsx(Ui,{className:"h-3 w-3"})}),n.jsx(z,{size:"icon",variant:"ghost",onClick:()=>l("negative"),disabled:s!==null||o.isPending,className:`h-6 w-6 ${s==="negative"?"bg-red-500/20 text-red-600 dark:text-red-400":"text-muted-foreground hover:text-red-600 dark:hover:text-red-400"}`,"data-testid":"button-feedback-negative",title:"Not helpful",children:n.jsx(Vi,{className:"h-3 w-3"})})]})}const z0e={ACSM:"American College of Sports Medicine",ACSM_HRMAX:"ACSM Heart Rate Maximum Guidelines",NSCA:"National Strength & Conditioning Association",NSCA_PROGRESSION:"NSCA Progressive Overload Principles",WHO:"World Health Organization",AND:"Academy of Nutrition & Dietetics",ADA:"American Diabetes Association",AHA:"American Heart Association"},KIe={ACSM:"https://www.acsm.org/education-resources/trending-topics-resources/physical-activity-guidelines",ACSM_HRMAX:"https://www.acsm.org/education-resources/trending-topics-resources/physical-activity-guidelines",NSCA:"https://www.nsca.com/education/articles/nsca-coach/essentials-of-strength-training-and-conditioning/",NSCA_PROGRESSION:"https://www.nsca.com/education/articles/nsca-coach/essentials-of-strength-training-and-conditioning/",WHO:"https://www.who.int/news-room/fact-sheets/detail/physical-activity",AND:"https://www.eatright.org/health/wellness/fad-diets/what-is-an-rd",ADA:"https://diabetes.org/health-wellness/fitness",AHA:"https://www.heart.org/en/healthy-living/fitness/fitness-basics/aha-recs-for-physical-activity-in-adults"};function H0e(e){const t=[],r=Object.keys(z0e).join("|"),a=new RegExp(`(${r}):\\s*([^.,(]+)`,"gi");let s;for(;(s=a.exec(e))!==null;)t.push({standard:s[1].toUpperCase(),text:s[2].trim()});const i=new RegExp(`[Pp]er\\s+(${r})(?:\\s+guidelines)?[,\\s]+([^.]+)`,"gi");for(;(s=i.exec(e))!==null;)t.push({standard:s[1].toUpperCase(),text:s[2].trim()});const o=new RegExp(`(${r})\\s+(recommends|suggests)\\s+([^.]+)`,"gi");for(;(s=o.exec(e))!==null;)t.push({standard:s[1].toUpperCase(),text:`${s[2]} ${s[3]}`.trim()});const l=new Set;return t.filter(c=>l.has(c.standard)?!1:(l.add(c.standard),!0))}function B0e(e){return z0e[e.toUpperCase()]||e}function q0e(e){return KIe[e.toUpperCase()]||null}function GIe({isOpen:e,onClose:t,context:r}){const{toast:a}=rt(),[s,i]=x.useState(!1),[o,l]=x.useState(!1),[c,d]=x.useState(!1),[u,h]=x.useState([]),p=x.useRef(null),f=x.useRef(null),y=x.useRef([]),v=x.useRef(!1),m=x.useRef(null),b=x.useRef(null),w=async()=>{try{const S=await navigator.mediaDevices.getUserMedia({audio:!0});m.current=S,f.current=new AudioContext({sampleRate:24e3}),f.current.state==="suspended"&&await f.current.resume(),console.log("🔑 Requesting authentication token...");const C=await pe("/api/voice-chat/token",{method:"POST"}),{token:A}=await C.json();console.log("✅ Got token, connecting to WebSocket...");const I=Rfe(),P=Dfe(),L=`${I}//${P}/api/voice-chat?token=${A}`;console.log(`🔌 Connecting to: ${L}`);const E=new WebSocket(L);p.current=E,E.onopen=()=>{console.log("✅ Voice chat connected"),i(!0),a({title:"Voice Chat Connected",description:"Your AI health coach is ready to chat!"})},E.onmessage=async R=>{var _;const q=JSON.parse(R.data);if(q.type==="session.created"||q.type==="session.updated")console.log("Session configured:",q);else if(q.type==="input_audio_buffer.speech_started")l(!0);else if(q.type==="input_audio_buffer.speech_stopped")l(!1),((_=p.current)==null?void 0:_.readyState)===WebSocket.OPEN&&(p.current.send(JSON.stringify({type:"input_audio_buffer.commit"})),p.current.send(JSON.stringify({type:"response.create"})));else if(q.type==="conversation.item.input_audio_transcription.completed")h(D=>[...D,{role:"user",text:q.transcript}]);else if(q.type==="response.audio_transcript.delta")h(D=>{const T=D[D.length-1];return(T==null?void 0:T.role)==="assistant"?[...D.slice(0,-1),{role:"assistant",text:T.text+q.delta}]:[...D,{role:"assistant",text:q.delta}]});else if(q.type==="response.audio.delta"){d(!0);const D=atob(q.delta),T=new Int16Array(D.length/2);for(let ee=0;ee<D.length;ee+=2)T[ee/2]=D.charCodeAt(ee+1)<<8|D.charCodeAt(ee);const F=new Float32Array(T.length);for(let ee=0;ee<T.length;ee++)F[ee]=T[ee]/32768;y.current.push(F),N()}else q.type==="response.audio.done"?d(!1):q.type==="error"&&(console.error("Voice chat error:",q.error),a({variant:"destructive",title:"Voice Chat Error",description:q.error.message}))},E.onerror=R=>{console.error("WebSocket error:",R),a({variant:"destructive",title:"Connection Error",description:"Failed to connect to voice chat"})},E.onclose=R=>{console.log("WebSocket closed:",R.code,R.reason),i(!1),l(!1),d(!1),h([]),R.code===4003?a({variant:"destructive",title:"Premium Required",description:"Voice chat requires a Premium subscription. Please upgrade to continue."}):R.code===4001&&a({variant:"destructive",title:"Authentication Required",description:"Please log in to use voice chat"})},k(S,E)}catch(S){console.error("Failed to connect:",S),a({variant:"destructive",title:"Microphone Access Required",description:"Please allow microphone access to use voice chat"})}},k=(S,C)=>{if(!f.current)return;const A=f.current,I=A.createMediaStreamSource(S),P=A.createScriptProcessor(4096,1,1);I.connect(P),P.connect(A.destination),P.onaudioprocess=L=>{if(!p.current||p.current.readyState!==WebSocket.OPEN)return;const E=L.inputBuffer.getChannelData(0),R=new Int16Array(E.length);for(let _=0;_<E.length;_++){const D=Math.max(-1,Math.min(1,E[_]));R[_]=D<0?D*32768:D*32767}const q=btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(R.buffer))));p.current.send(JSON.stringify({type:"input_audio_buffer.append",audio:q}))}},N=async()=>{if(!(v.current||!f.current)&&y.current.length!==0){for(f.current.state==="suspended"&&await f.current.resume(),v.current=!0;y.current.length>0;){const S=y.current.shift(),C=f.current.createBuffer(1,S.length,24e3);C.getChannelData(0).set(S);const A=f.current.createBufferSource();A.buffer=C,A.connect(f.current.destination),await new Promise(I=>{A.onended=()=>I(),A.start()})}v.current=!1}},j=()=>{p.current&&(p.current.close(),p.current=null),m.current&&(m.current.getTracks().forEach(S=>S.stop()),m.current=null),f.current&&(f.current.close(),f.current=null),i(!1),l(!1),d(!1)};x.useEffect(()=>{e&&!s&&w()},[e]),x.useEffect(()=>{e||j()},[e]),x.useEffect(()=>()=>{j()},[]),x.useEffect(()=>{var S;(S=b.current)==null||S.scrollIntoView({behavior:"smooth"})},[u]);const M=S=>{S.target===S.currentTarget&&t()};return e?n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm p-4",onClick:M,"data-testid":"voice-chat-modal-backdrop",children:n.jsx(H,{className:"w-full max-w-2xl bg-background/95 backdrop-blur-md shadow-2xl border-2 border-primary/20",children:n.jsxs("div",{className:"flex flex-col h-[min(80vh,600px)]",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2 p-4 border-b bg-gradient-to-r from-green-600 to-green-700 text-white rounded-t-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ve,{className:"h-5 w-5"}),n.jsx("h3",{className:"font-semibold",children:"Voice Coach"}),n.jsx(Q,{variant:"secondary",className:"bg-white/20 text-white border-white/30",children:"Premium"})]}),n.jsx(z,{size:"icon",variant:"ghost",onClick:t,className:"h-8 w-8 text-white hover:bg-white/20","data-testid":"button-close-voice-modal",children:n.jsx(ta,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[u.length===0?n.jsx("div",{className:"flex flex-col items-center justify-center h-full text-center space-y-4",children:s?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-center gap-8",children:[n.jsxs("div",{className:"flex flex-col items-center gap-2",children:[n.jsx("div",{className:`p-4 rounded-full ${o?"bg-green-500/20":"bg-muted"}`,children:o?n.jsx(Jc,{className:"w-12 h-12 text-green-500 animate-pulse","data-testid":"icon-mic-active"}):n.jsx(Om,{className:"w-12 h-12 text-muted-foreground","data-testid":"icon-mic-inactive"})}),n.jsx("p",{className:"text-sm text-muted-foreground",children:o?"Listening...":"Ready"})]}),n.jsxs("div",{className:"flex flex-col items-center gap-2",children:[n.jsx("div",{className:`p-4 rounded-full ${c?"bg-primary/20":"bg-muted"}`,children:n.jsx(Ve,{className:`w-12 h-12 ${c?"text-primary animate-pulse":"text-muted-foreground"}`,"data-testid":"icon-ai-speaking"})}),n.jsx("p",{className:"text-sm text-muted-foreground",children:c?"AI Speaking...":"Idle"})]})]}),n.jsx("p",{className:"text-sm text-muted-foreground max-w-sm mt-4",children:"Start speaking! Your AI health coach is listening and will respond naturally."})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"p-6 rounded-full bg-primary/10",children:n.jsx(nt,{className:"h-12 w-12 text-primary animate-spin"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-lg mb-2",children:"Connecting..."}),n.jsx("p",{className:"text-muted-foreground text-sm max-w-sm",children:"Setting up your voice connection with the AI health coach."})]})]})}):n.jsx(n.Fragment,{children:u.map((S,C)=>n.jsx("div",{className:`flex ${S.role==="user"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`rounded-lg p-4 max-w-[80%] ${S.role==="user"?"bg-primary/10":"bg-muted"}`,"data-testid":`transcript-${S.role}-${C}`,children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:S.role==="user"?"You":"AI Coach"}),n.jsx("p",{className:"whitespace-pre-wrap",children:S.text})]})},C))}),n.jsx("div",{ref:b})]}),s&&n.jsx("div",{className:"border-t p-4 bg-muted/30",children:n.jsxs("div",{className:"flex items-center justify-center gap-8",children:[o&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((S,C)=>n.jsx("div",{className:"w-1 bg-green-500 rounded-full animate-pulse",style:{height:`${12+Math.random()*16}px`,animationDelay:`${C*.1}s`,animationDuration:"0.8s"}},C))}),n.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"Listening..."})]}),c&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((S,C)=>n.jsx("div",{className:"w-1 bg-primary rounded-full animate-pulse",style:{height:`${12+Math.random()*16}px`,animationDelay:`${C*.1}s`,animationDuration:"1s"}},C))}),n.jsx("span",{className:"text-sm text-primary",children:"AI Speaking..."})]}),!o&&!c&&n.jsx("p",{className:"text-sm text-muted-foreground",children:"Speak naturally - I'm listening!"})]})})]})})}):null}function YIe({isOpen:e,onClose:t,currentPage:r,context:a}){const{toast:s}=rt(),[i,o]=x.useState(""),l=x.useRef(null),[c,d]=x.useState(!0),{status:u}=R0e(),[h,p]=x.useState(0),f=x.useMemo(()=>e?new Date().toISOString():null,[h]),[y,v]=x.useState(!1),[m,b]=x.useState(!1),w=x.useRef(null),[k,N]=x.useState(!1),[j,M]=x.useState(!1);x.useEffect(()=>{const T=window.SpeechRecognition||window.webkitSpeechRecognition;if(N(!!T),M("speechSynthesis"in window),T){const F=new T;F.continuous=!1,F.interimResults=!1,F.lang="en-US",F.onresult=ee=>{const oe=ee.results[0][0].transcript;o(K=>K+(K?" ":"")+oe)},F.onerror=ee=>{console.error("Speech recognition error:",ee.error),v(!1),ee.error!=="no-speech"&&ee.error!=="aborted"&&s({title:"Voice Input Error",description:"Could not understand speech. Please try again.",variant:"destructive"})},F.onend=()=>{v(!1)},w.current=F}return()=>{w.current&&w.current.stop()}},[s]);const S=()=>{if(w.current)if(y)w.current.stop(),v(!1);else try{w.current.start(),v(!0)}catch(T){console.error("Error starting speech recognition:",T),s({title:"Error",description:"Could not start voice input",variant:"destructive"})}},C=T=>{if(!m||!("speechSynthesis"in window))return;window.speechSynthesis.cancel();const F=new SpeechSynthesisUtterance(T);F.rate=.9,F.pitch=1,F.volume=1,window.speechSynthesis.speak(F)};x.useEffect(()=>{e&&(p(T=>T+1),d(!0))},[e]);const{data:A,isLoading:I}=we({queryKey:["/api/chat/history"],enabled:e}),P=Se({mutationFn:async T=>(await pe("POST","/api/chat",{message:T,currentPage:r||"Unknown Page"})).json(),onSuccess:T=>{le.invalidateQueries({queryKey:["/api/chat/history"]}),le.invalidateQueries({queryKey:["/api/onboarding/status"]}),o(""),T.contextualOnboardingTriggered&&p(F=>F+1),T.reply&&m&&C(T.reply),T.trainingPlanSaved&&(le.invalidateQueries({queryKey:["/api/training-schedules"]}),s({title:"Training Plan Added! 🎉",description:"Your personalized workout plan has been added to your Training page"})),T.mealPlanSaved&&(le.invalidateQueries({queryKey:["/api/meal-plans"]}),s({title:"Meal Plan Added! 🍽️",description:"Your personalized meal plan has been added to your Meal Plans page"})),T.goalSaved&&(le.invalidateQueries({queryKey:["/api/goals"]}),s({title:"Goal Added! 🎯",description:"Your health goal has been added to your Goals page.",action:n.jsx(dX,{altText:"View Goals",asChild:!0,children:n.jsx(_r,{href:"/goals",children:"View Goals"})})})),T.exerciseSaved&&(le.invalidateQueries({queryKey:["/api/scheduled-exercises"]}),le.invalidateQueries({queryKey:["/api/exercise-recommendations"]}),le.invalidateQueries({queryKey:["/api/training-schedules"]}),s({title:"Exercise Added! 💪",description:"Your exercise has been added to your Training page"}))},onError:T=>{s({title:"Error",description:T.message||"Failed to send message",variant:"destructive"})}}),L=()=>{p(T=>T+1),s({title:"Chat cleared",description:"Your conversation history is preserved for AI context"})},E=u&&!u.basicInfoComplete,R=()=>{var T;(T=l.current)==null||T.scrollIntoView({behavior:"smooth"})};x.useEffect(()=>{e&&!c&&R()},[A,e,c]),x.useEffect(()=>{e&&a==="goals"&&!P.isPending&&(P.mutate("Help me set some personalized health goals based on my current health data and biomarkers. What goals would you recommend?"),d(!1))},[e,a]);const q=T=>{T.preventDefault(),i.trim()&&!P.isPending&&P.mutate(i.trim())},_=T=>{T.key==="Enter"&&!T.shiftKey&&(T.preventDefault(),q(T))},D=T=>{switch(T){case"Dashboard":return"What would you like to know about your health overview?";case"Training":return"How can I help optimize your training today?";case"Meal Plans":return"What kind of meal plan are you looking for?";case"Biomarkers":return"Would you like help understanding your biomarker data?";case"Supplement Stack":return"Need recommendations for your supplement stack?";case"Sleep Dashboard":return"Want tips to improve your sleep quality?";case"Health Goals":return"What health goals would you like to work on?";case"Health Records":return"Would you like me to analyze your health records?";case"Workout History":return"Want to review your workout performance?";default:return"How can I help you with your health journey today?"}};return e?n.jsx("div",{style:{position:"fixed",bottom:"1rem",right:"1rem"},className:`z-50 flex flex-col w-[calc(100vw-2rem)] sm:w-80 md:w-96 max-w-md ${c?"max-h-[60px]":"h-[min(max(10rem,calc(100dvh-2rem)),600px)]"}`,children:n.jsxs(H,{className:"flex flex-col h-full shadow-lg bg-background/90 border-purple-500/50",children:[n.jsx("div",{className:"border-b bg-gradient-to-r from-purple-600 to-purple-700 text-white",children:n.jsxs("div",{className:"flex items-center justify-between gap-2 p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ve,{className:"h-5 w-5"}),n.jsx("h3",{className:"font-semibold",children:E?"Getting Started":"Health Coach"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[j&&!E&&n.jsx(z,{size:"icon",variant:"ghost",onClick:()=>b(!m),className:"h-8 w-8 text-white hover:bg-white/20","data-testid":"button-toggle-voice-output",title:m?"Disable voice output":"Enable voice output",children:m?n.jsx(qx,{className:"h-4 w-4"}):n.jsx(Vx,{className:"h-4 w-4"})}),A&&A.length>0&&!E&&n.jsx(z,{size:"icon",variant:"ghost",onClick:L,className:"h-8 w-8 text-white hover:bg-white/20","data-testid":"button-clear-chat",title:"Clear chat (keeps history for context)",children:n.jsx(Xr,{className:"h-4 w-4"})}),!E&&n.jsx(z,{size:"icon",variant:"ghost",onClick:()=>d(!c),className:"h-8 w-8 text-white hover:bg-white/20","data-testid":"button-minimize-chat",children:n.jsx(Lx,{className:"h-4 w-4"})}),n.jsx(z,{size:"icon",variant:"ghost",onClick:t,className:"h-8 w-8 text-white hover:bg-white/20","data-testid":"button-close-chat",children:n.jsx(ta,{className:"h-4 w-4"})})]})]})}),!c&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[I?n.jsx("div",{className:"flex items-center justify-center h-32",children:n.jsx(nt,{className:"h-6 w-6 animate-spin"})}):(()=>{const T=A&&f?A.filter(F=>F.createdAt?(typeof F.createdAt=="string"?F.createdAt:F.createdAt.toISOString())>=f:!1):A||[];return T.length>0?T.map((F,ee)=>{const oe=F.role==="assistant"?H0e(F.content):[];return n.jsx("div",{className:`flex ${F.role==="user"?"justify-end":"justify-start"}`,"data-testid":`floating-message-${F.role}-${ee}`,children:n.jsxs("div",{className:"flex flex-col gap-2 max-w-[85%]",children:[n.jsx("div",{className:`rounded-lg p-3 text-sm ${F.role==="user"?"bg-primary text-primary-foreground":"bg-muted"}`,children:n.jsx("p",{className:"whitespace-pre-wrap break-words",children:F.content})}),oe.length>0&&n.jsx("div",{className:"flex items-center gap-1 flex-wrap px-1",children:n.jsx(Rc,{children:oe.map((K,ne)=>{const me=q0e(K.standard),ue=n.jsxs(Q,{variant:"outline",className:"text-xs gap-1 bg-primary/5 border-primary/20 hover:bg-primary/10 cursor-pointer","data-testid":`badge-text-citation-${K.standard.toLowerCase()}`,children:[n.jsx(br,{className:"h-3 w-3"}),K.standard,me&&n.jsx(Em,{className:"h-3 w-3 ml-0.5"})]});return n.jsxs(xl,{children:[n.jsx(vl,{asChild:!0,children:me?n.jsx("a",{href:me,target:"_blank",rel:"noopener noreferrer",className:"inline-flex","data-testid":`link-text-citation-${K.standard.toLowerCase()}`,children:ue}):ue}),n.jsx(jo,{side:"bottom",className:"max-w-xs",children:n.jsxs("p",{className:"text-xs",children:[n.jsxs("strong",{children:[B0e(K.standard),":"]})," ",K.text,me&&n.jsx("span",{className:"block mt-1 text-primary",children:"Click to learn more →"})]})})]},ne)})})}),F.role==="assistant"&&n.jsx("div",{className:"flex justify-end",children:n.jsx(WIe,{messageId:F.id,conversationType:"text"})})]})},F.id)}):n.jsx("div",{className:"flex justify-start",children:n.jsx("div",{className:"max-w-[85%] rounded-lg p-3 bg-muted text-sm",children:n.jsx("p",{className:"whitespace-pre-wrap break-words",children:D(r)})})})})(),P.isPending&&n.jsx("div",{className:"flex justify-start",children:n.jsx("div",{className:"max-w-[85%] rounded-lg p-3 bg-muted",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(nt,{className:"h-3 w-3 animate-spin"}),n.jsx("p",{className:"text-sm",children:"Thinking..."})]})})}),n.jsx("div",{ref:l})]}),n.jsx("div",{className:"border-t p-3",children:n.jsxs("form",{onSubmit:q,className:"flex gap-2",children:[n.jsx("textarea",{value:i,onChange:T=>o(T.target.value),onKeyPress:_,placeholder:y?"Listening...":"Ask your health coach...",className:`flex-1 resize-none rounded-md border bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${y?"ring-2 ring-purple-500 animate-pulse":""}`,rows:2,disabled:P.isPending,"data-testid":"input-floating-chat-message"}),n.jsxs("div",{className:"flex flex-col gap-2",children:[k&&n.jsx(z,{type:"button",size:"icon",variant:y?"default":"outline",onClick:S,disabled:P.isPending,"data-testid":"button-voice-input",title:y?"Stop listening":"Start voice input",children:y?n.jsx(Om,{className:"h-4 w-4"}):n.jsx(Jc,{className:"h-4 w-4"})}),n.jsx(z,{type:"submit",size:"icon",disabled:!i.trim()||P.isPending,"data-testid":"button-send-floating-message",children:n.jsx(U1,{className:"h-4 w-4"})})]})]})})]})]})}):null}function XIe({onClick:e,subscriptionTier:t="free"}){return n.jsx(z,{size:"icon",style:{position:"fixed",bottom:"1rem",right:"1rem"},className:"z-40 h-10 w-10 rounded-full shadow-lg bg-primary hover:bg-primary/90 border-2 border-primary/50 hover:border-primary/70 animate-pulse hover:animate-none transition-all hover:scale-110",onClick:e,"data-testid":"button-open-floating-chat",children:n.jsx(Ve,{className:"h-5 w-5 text-primary-foreground"})})}function ZIe(){const{isAuthenticated:e}=oH(),t=x.useRef(null),r=x.useRef(!1),{data:a}=we({queryKey:["/api/profile"],enabled:e}),s=Se({mutationFn:async l=>(await pe("PATCH","/api/user/settings",{timezone:l}),l),onSuccess:l=>{t.current=l,le.invalidateQueries({queryKey:["/api/profile"]}),le.invalidateQueries({queryKey:["/api/auth/user"]}),console.log("✅ Timezone synced successfully:",l)},onError:l=>{r.current=!1,t.current=null,console.error("❌ Failed to sync timezone, will retry:",{message:(l==null?void 0:l.message)||"Unknown error",status:l==null?void 0:l.status,response:l==null?void 0:l.response,error:l})}}),i=()=>{try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(l){return console.error("Failed to detect timezone:",l),null}},o=()=>{if(!e||s.isPending)return;const l=i();if(l&&l!==t.current){if((a==null?void 0:a.timezone)===l){t.current=l;return}t.current!==l&&(console.log(`🌍 Timezone detected: ${l}`,a!=null&&a.timezone?`(stored: ${a.timezone})`:"(first sync)"),r.current=!0,s.mutate(l))}};return x.useEffect(()=>{e&&a&&o()},[e,a]),x.useEffect(()=>{if(!e)return;const l=()=>{document.visibilityState==="visible"&&o()};document.addEventListener("visibilitychange",l);const c=setInterval(()=>{o()},60*60*1e3);return()=>{document.removeEventListener("visibilitychange",l),clearInterval(c)}},[e,a,s.isPending]),null}const un=tb,V0e=rH,QIe=rb,U0e=x.forwardRef(({className:e,...t},r)=>n.jsx(Nf,{ref:r,className:xe("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));U0e.displayName=Nf.displayName;const Qr=x.forwardRef(({className:e,children:t,...r},a)=>n.jsxs(QIe,{children:[n.jsx(U0e,{}),n.jsxs(Sf,{ref:a,className:xe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,n.jsxs(nb,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[n.jsx(ta,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Qr.displayName=Sf.displayName;const Jr=({className:e,...t})=>n.jsx("div",{className:xe("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Jr.displayName="DialogHeader";const Uo=({className:e,...t})=>n.jsx("div",{className:xe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Uo.displayName="DialogFooter";const en=x.forwardRef(({className:e,...t},r)=>n.jsx(R0,{ref:r,className:xe("text-lg font-semibold leading-none tracking-tight",e),...t}));en.displayName=R0.displayName;const Pn=x.forwardRef(({className:e,...t},r)=>n.jsx($0,{ref:r,className:xe("text-sm text-muted-foreground",e),...t}));Pn.displayName=$0.displayName;function lb(e){const t=x.useRef({value:e,previous:e});return x.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var UX="Checkbox",[JIe,L4t]=hn(UX),[eLe,tLe]=JIe(UX),W0e=x.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:a,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u,...h}=e,[p,f]=x.useState(null),y=st(t,N=>f(N)),v=x.useRef(!1),m=p?u||!!p.closest("form"):!0,[b=!1,w]=ua({prop:s,defaultProp:i,onChange:d}),k=x.useRef(b);return x.useEffect(()=>{const N=p==null?void 0:p.form;if(N){const j=()=>w(k.current);return N.addEventListener("reset",j),()=>N.removeEventListener("reset",j)}},[p,w]),n.jsxs(eLe,{scope:r,state:b,disabled:l,children:[n.jsx($e.button,{type:"button",role:"checkbox","aria-checked":td(b)?"mixed":b,"aria-required":o,"data-state":Y0e(b),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:y,onKeyDown:Ne(e.onKeyDown,N=>{N.key==="Enter"&&N.preventDefault()}),onClick:Ne(e.onClick,N=>{w(j=>td(j)?!0:!j),m&&(v.current=N.isPropagationStopped(),v.current||N.stopPropagation())})}),m&&n.jsx(rLe,{control:p,bubbles:!v.current,name:a,value:c,checked:b,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"},defaultChecked:td(i)?!1:i})]})});W0e.displayName=UX;var K0e="CheckboxIndicator",G0e=x.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:a,...s}=e,i=tLe(K0e,r);return n.jsx(bn,{present:a||td(i.state)||i.state===!0,children:n.jsx($e.span,{"data-state":Y0e(i.state),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});G0e.displayName=K0e;var rLe=e=>{const{control:t,checked:r,bubbles:a=!0,defaultChecked:s,...i}=e,o=x.useRef(null),l=lb(r),c=Yv(t);x.useEffect(()=>{const u=o.current,h=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==r&&f){const y=new Event("click",{bubbles:a});u.indeterminate=td(r),f.call(u,td(r)?!1:r),u.dispatchEvent(y)}},[l,r,a]);const d=x.useRef(td(r)?!1:r);return n.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??d.current,...i,tabIndex:-1,ref:o,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function td(e){return e==="indeterminate"}function Y0e(e){return td(e)?"indeterminate":e?"checked":"unchecked"}var X0e=W0e,nLe=G0e;const rs=x.forwardRef(({className:e,...t},r)=>n.jsx(X0e,{ref:r,className:xe("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:n.jsx(nLe,{className:xe("flex items-center justify-center text-current"),children:n.jsx(fr,{className:"h-4 w-4"})})}));rs.displayName=X0e.displayName;function aLe({open:e,onAccept:t,isAccepting:r=!1}){const[a,s]=x.useState(!1),[i,o]=x.useState(!1),l=h=>{const p=Math.abs(h.scrollHeight-h.scrollTop-h.clientHeight)<10;console.log("Scroll check:",{scrollHeight:h.scrollHeight,scrollTop:h.scrollTop,clientHeight:h.clientHeight,isAtBottom:p}),p&&!a&&(console.log("Setting hasScrolledToBottom to true"),s(!0))},c=h=>{l(h.target)},d=a&&i;console.log("EULA Dialog state:",{hasScrolledToBottom:a,hasAgreed:i,canAccept:d});const u=()=>{console.log("EULA Accept button clicked",{canAccept:d,hasScrolledToBottom:a,hasAgreed:i}),t()};return n.jsx(un,{open:e,onOpenChange:()=>{},modal:!0,children:n.jsxs(Qr,{className:"max-w-4xl max-h-[90vh] flex flex-col",onEscapeKeyDown:h=>h.preventDefault(),children:[n.jsxs(Jr,{children:[n.jsx(en,{className:"text-2xl",children:"End User License Agreement (EULA)"}),n.jsx(Pn,{children:"Please read and accept the terms before using HealthPilot"})]}),n.jsx("div",{className:"flex-1 overflow-y-auto border rounded-md p-4 touch-pan-y",onScroll:c,style:{WebkitOverflowScrolling:"touch"},children:n.jsxs("div",{className:"space-y-4 text-sm pr-4",children:[n.jsx("div",{children:n.jsxs("p",{className:"font-semibold mb-2",children:["Last Updated: 1/08/2025",n.jsx("br",{}),"Effective Date: 1/08/2025",n.jsx("br",{}),'Owner: Nuvitae Labs ("we," "us," "our")',n.jsx("br",{}),'Product: HealthPilot – AI-Driven Health, Fitness and Longevity Application ("the App")']})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"1. Acceptance of Terms"}),n.jsx("p",{children:'By downloading, accessing, or using the App, you ("the User") agree to be bound by this End User Licence Agreement ("Agreement"). If you do not agree, do not use the App. We may update or amend this Agreement at any time. Continued use after such changes constitutes acceptance of the revised terms.'})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"2. Licence Grant"}),n.jsx("p",{children:"We grant you a non-exclusive, non-transferable, revocable licence to use the App for personal, non-commercial purposes, subject to this Agreement. You must not copy, distribute, modify, reverse engineer, or exploit any part of the App or its content."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"3. Subscription and Payment"}),n.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[n.jsx("li",{children:"The App offers both free and paid subscription tiers."}),n.jsx("li",{children:"Subscription fees are billed monthly or annually, depending on your selection at sign-up."}),n.jsx("li",{children:"All payments are processed through secure third-party providers. You authorise recurring charges until you cancel your subscription."}),n.jsx("li",{children:"Prices and plans may change at our discretion with prior notice."})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"4. Account Registration"}),n.jsx("p",{className:"mb-2",children:"To use certain features, you must create an account. You agree to:"}),n.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[n.jsx("li",{children:"Provide accurate and complete information,"}),n.jsx("li",{children:"Keep your credentials secure, and"}),n.jsx("li",{children:"Accept full responsibility for all activity under your account."})]}),n.jsx("p",{className:"mt-2",children:"We reserve the right to suspend or terminate accounts for misuse or breach of this Agreement."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"5. Use of AI and Health Data"}),n.jsx("p",{className:"mb-2",children:"The App analyses personal information, including:"}),n.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[n.jsx("li",{children:"Uploaded blood work and medical results,"}),n.jsx("li",{children:"Data from connected wearables (e.g., Apple HealthKit, Fitbit, etc.), and"}),n.jsx("li",{children:"Other health-related inputs."})]}),n.jsx("p",{className:"mt-2 mb-2",children:"The App uses artificial intelligence to generate insights, recommendations, and a biological-age assessment. You acknowledge that:"}),n.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[n.jsx("li",{children:"Outputs are AI-generated and not medical advice,"}),n.jsx("li",{children:"The App does not diagnose, treat, or prevent disease, and"}),n.jsx("li",{children:"You should always consult a qualified medical professional before acting on any recommendation."})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"6. Data Collection and Privacy"}),n.jsx("p",{className:"mb-2",children:"We collect and store certain personal information as described in our Privacy Policy. Key points:"}),n.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[n.jsx("li",{children:"Health data and other information are stored securely and encrypted."}),n.jsx("li",{children:"We may use anonymised or aggregated data for analytics, research, or to train AI models."}),n.jsx("li",{children:"We do not sell identifiable personal data to third parties."}),n.jsx("li",{children:"By using the App, you consent to the processing and storage of your data in accordance with applicable laws (including the Australian Privacy Act 1988 (Cth), GDPR, and similar international laws where relevant)."})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"7. Intellectual Property"}),n.jsx("p",{children:"All intellectual property rights in the App, algorithms, software, and related materials are and remain the exclusive property of Nuvitae Labs. You may not use our trademarks, trade names, or branding without written consent."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"8. User Responsibilities"}),n.jsx("p",{className:"mb-2",children:"You agree not to:"}),n.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[n.jsx("li",{children:"Use the App for any unlawful purpose or in violation of any local, national, or international law;"}),n.jsx("li",{children:"Attempt to gain unauthorised access to the App or its servers;"}),n.jsx("li",{children:"Input false or misleading data; or"}),n.jsx("li",{children:"Resell, sublicense, or make the App available to others in violation of this Agreement."})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"9. Disclaimers"}),n.jsx("p",{className:"mb-2",children:"To the maximum extent permitted by law:"}),n.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[n.jsx("li",{children:'The App is provided "as is" and "as available."'}),n.jsx("li",{children:"We make no warranties that the App will be error-free, uninterrupted, or that results will be accurate or reliable."}),n.jsx("li",{children:"Any reliance on AI-generated recommendations is at your own risk."}),n.jsx("li",{children:"The App is intended for informational and educational purposes only and not a substitute for professional medical advice, diagnosis, or treatment."})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"10. Limitation of Liability"}),n.jsx("p",{className:"mb-2",children:"To the fullest extent permitted by law:"}),n.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[n.jsx("li",{children:"We are not liable for any indirect, incidental, consequential, or punitive damages, including loss of data, health outcomes, profits, or business interruption."}),n.jsx("li",{children:"Our total liability for any claim arising from or relating to this Agreement shall not exceed the total amount you paid for the App in the preceding 12-month period."})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"11. Termination"}),n.jsx("p",{children:"We may suspend or terminate your access without notice if you breach this Agreement or misuse the App. Upon termination, your right to use the App immediately ceases. Sections 7, 9, 10, and 13 will survive termination."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"12. Third-Party Services"}),n.jsx("p",{children:"The App may integrate or interact with third-party services such as Apple HealthKit, Google Fit, or other APIs. We are not responsible for third-party terms, data practices, or service availability."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"13. Governing Law and Jurisdiction"}),n.jsx("p",{children:"This Agreement is governed by the laws of Western Australia. You agree to submit to the exclusive jurisdiction of the courts of Western Australia to resolve any disputes."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"14. Severability"}),n.jsx("p",{children:"If any provision of this Agreement is found invalid or unenforceable, the remaining provisions will remain in full effect."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold mb-2",children:"15. Entire Agreement"}),n.jsx("p",{children:"This Agreement, together with the Privacy Policy, constitutes the entire understanding between you and Nuvitae Labs regarding your use of HealthPilot and supersedes all prior agreements or communications."})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h3",{className:"font-semibold mb-2",children:"Contact Information"}),n.jsxs("p",{children:["If you have questions about this Agreement, please contact:",n.jsx("br",{}),"Nuvitae Labs",n.jsx("br",{}),"Email: support@nuvitaelabs.com",n.jsx("br",{}),"Website: nuvitaelabs.com",n.jsx("br",{}),"Location: Perth, Western Australia"]})]})]})}),n.jsxs("div",{className:"flex items-center space-x-2 py-4",children:[n.jsx(rs,{id:"agree",checked:i,onCheckedChange:h=>o(h),"data-testid":"checkbox-eula-agree",disabled:!a}),n.jsxs("label",{htmlFor:"agree",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:["I have read and agree to the End User License Agreement",!a&&n.jsx("span",{className:"text-muted-foreground ml-1",children:"(scroll to bottom first)"})]})]}),n.jsx(Uo,{className:"gap-2",children:n.jsx(z,{type:"button",onClick:u,disabled:!d||r,"data-testid":"button-accept-eula",className:"w-full sm:w-auto",children:r?"Accepting...":"Accept and Continue"})})]})})}const zq=hs("Health",{web:()=>Bi(()=>import("./web-DtSaqNzk.js"),[]).then(e=>new e.HealthWeb)});class d1{constructor(){this.isAvailable=null}static getInstance(){return d1.instance||(d1.instance=new d1),d1.instance}async isHealthKitAvailable(){if(this.isAvailable!==null)return this.isAvailable;try{if(va.getPlatform()!=="ios")return this.isAvailable=!1,!1;const t=await zq.isAvailable();return this.isAvailable=(t==null?void 0:t.available)??!1,console.log("[HealthKit] Availability check result:",this.isAvailable),this.isAvailable}catch(t){return console.warn("[HealthKit] Plugin check failed:",t.message),this.isAvailable=!1,!1}}async requestPermissions(){if(!await this.isHealthKitAvailable())return console.log("[HealthKit] Not available on this platform"),!1;try{console.log("[HealthKit] Requesting permissions for ALL 26 health data types...");const r=await zq.requestAuthorization({read:["steps","distance","calories","heartRate","weight","hrv","restingHeartRate","bloodPressureSystolic","bloodPressureDiastolic","oxygenSaturation","respiratoryRate","height","bmi","bodyFat","leanBodyMass","basalCalories","flightsClimbed","bloodGlucose","bodyTemperature","vo2Max","walkingHeartRateAverage","waistCircumference","dietaryWater","exerciseTime","standTime","sleepAnalysis"],write:[]});return console.log("[HealthKit] Permission request result:",r),r.readAuthorized.length>0}catch(r){throw console.error("[HealthKit] Failed to request permissions:",r),r}}async queryData(t,r,a){var s;try{console.log(`[HealthKit] Querying ${t} from ${r.toISOString()} to ${a.toISOString()}`);const i=await zq.readSamples({dataType:t,startDate:r.toISOString(),endDate:a.toISOString(),limit:1e3,ascending:!1});return console.log(`[HealthKit] ${t} returned ${((s=i.samples)==null?void 0:s.length)||0} samples`),i.samples&&i.samples.length>0&&console.log(`[HealthKit] ${t} sample example:`,i.samples[0]),i.samples||[]}catch(i){return console.error(`[HealthKit] Failed to query ${t}:`,i),[]}}async getSteps(t,r){return this.queryData("steps",t,r)}async getDistance(t,r){return this.queryData("distance",t,r)}async getActiveCalories(t,r){return this.queryData("calories",t,r)}async getHeartRate(t,r){return this.queryData("heartRate",t,r)}async getRestingHeartRate(t,r){return this.queryData("restingHeartRate",t,r)}async getHRV(t,r){return this.queryData("hrv",t,r)}async getWeight(t,r){return this.queryData("weight",t,r)}async getLeanBodyMass(t,r){return console.log("[HealthKit] Lean body mass not yet supported by Capgo Health plugin"),[]}async getBodyFat(t,r){return console.log("[HealthKit] Body fat not yet supported by Capgo Health plugin"),[]}async getBloodPressureSystolic(t,r){return this.queryData("bloodPressureSystolic",t,r)}async getBloodPressureDiastolic(t,r){return this.queryData("bloodPressureDiastolic",t,r)}async getBloodGlucose(t,r){return console.log("[HealthKit] Blood glucose not yet supported by Capgo Health plugin"),[]}async getBasalCalories(t,r){return console.log("[HealthKit] Basal calories not yet supported by Capgo Health plugin"),[]}async getFlightsClimbed(t,r){return console.log("[HealthKit] Flights climbed not yet supported by Capgo Health plugin"),[]}async getOxygenSaturation(t,r){return this.queryData("oxygenSaturation",t,r)}async getRespiratoryRate(t,r){return this.queryData("respiratoryRate",t,r)}async getBodyTemperature(t,r){return console.log("[HealthKit] Body temperature not yet supported by Capgo Health plugin"),[]}async getBMI(t,r){return console.log("[HealthKit] BMI not yet supported by Capgo Health plugin"),[]}async getHeight(t,r){return console.log("[HealthKit] Height not yet supported by Capgo Health plugin"),[]}async getWaistCircumference(t,r){return console.log("[HealthKit] Waist circumference not yet supported by Capgo Health plugin"),[]}async getDietaryWater(t,r){return console.log("[HealthKit] Dietary water not yet supported by Capgo Health plugin"),[]}async getDietaryEnergy(t,r){return console.log("[HealthKit] Dietary energy not yet supported by Capgo Health plugin"),[]}async getDietaryProtein(t,r){return console.log("[HealthKit] Dietary protein not yet supported by Capgo Health plugin"),[]}async getDietaryCarbs(t,r){return console.log("[HealthKit] Dietary carbs not yet supported by Capgo Health plugin"),[]}async getDietaryFat(t,r){return console.log("[HealthKit] Dietary fat not yet supported by Capgo Health plugin"),[]}async getWorkouts(t,r){return console.log("[HealthKit] Workouts not yet supported by Capgo Health plugin"),[]}async getSleep(t,r){return console.log("[HealthKit] Sleep not yet supported by Capgo Health plugin"),[]}async getAllHealthData(t=30){if(!await this.isHealthKitAvailable())return console.log("[HealthKit] Not available, returning empty data"),{steps:[],distance:[],activeCalories:[],basalCalories:[],flightsClimbed:[],heartRate:[],restingHeartRate:[],hrv:[],oxygenSaturation:[],respiratoryRate:[],bodyTemperature:[],weight:[],bmi:[],leanBodyMass:[],bodyFat:[],height:[],waistCircumference:[],bloodPressureSystolic:[],bloodPressureDiastolic:[],bloodGlucose:[],dietaryWater:[],dietaryEnergy:[],dietaryProtein:[],dietaryCarbs:[],dietaryFat:[],workouts:[],sleep:[]};const a=new Date,s=new Date;s.setDate(s.getDate()-t);try{const[i,o,l,c,d,u,h,p,f,y,v,m,b,w,k,N,j,M,S,C,A,I,P,L,E,R,q]=await Promise.all([this.getSteps(s,a),this.getDistance(s,a),this.getActiveCalories(s,a),this.getBasalCalories(s,a),this.getFlightsClimbed(s,a),this.getHeartRate(s,a),this.getRestingHeartRate(s,a),this.getHRV(s,a),this.getOxygenSaturation(s,a),this.getRespiratoryRate(s,a),this.getBodyTemperature(s,a),this.getWeight(s,a),this.getBMI(s,a),this.getLeanBodyMass(s,a),this.getBodyFat(s,a),this.getHeight(s,a),this.getWaistCircumference(s,a),this.getBloodPressureSystolic(s,a),this.getBloodPressureDiastolic(s,a),this.getBloodGlucose(s,a),this.getDietaryWater(s,a),this.getDietaryEnergy(s,a),this.getDietaryProtein(s,a),this.getDietaryCarbs(s,a),this.getDietaryFat(s,a),this.getWorkouts(s,a),this.getSleep(s,a)]);return console.log("[HealthKit] Comprehensive health data retrieved:",{steps:i.length,distance:o.length,activeCalories:l.length,basalCalories:c.length,flightsClimbed:d.length,heartRate:u.length,restingHeartRate:h.length,hrv:p.length,oxygenSaturation:f.length,respiratoryRate:y.length,bodyTemperature:v.length,weight:m.length,bmi:b.length,leanBodyMass:w.length,bodyFat:k.length,height:N.length,waistCircumference:j.length,bloodPressureSystolic:M.length,bloodPressureDiastolic:S.length,bloodGlucose:C.length,dietaryWater:A.length,dietaryEnergy:I.length,dietaryProtein:P.length,dietaryCarbs:L.length,dietaryFat:E.length,workouts:R.length,sleep:q.length}),{steps:i,distance:o,activeCalories:l,basalCalories:c,flightsClimbed:d,heartRate:u,restingHeartRate:h,hrv:p,oxygenSaturation:f,respiratoryRate:y,bodyTemperature:v,weight:m,bmi:b,leanBodyMass:w,bodyFat:k,height:N,waistCircumference:j,bloodPressureSystolic:M,bloodPressureDiastolic:S,bloodGlucose:C,dietaryWater:A,dietaryEnergy:I,dietaryProtein:P,dietaryCarbs:L,dietaryFat:E,workouts:R,sleep:q}}catch(i){throw console.error("[HealthKit] Failed to retrieve comprehensive health data:",i),i}}async syncAllHealthData(t=30){try{console.log(`[HealthKit] Starting sync of last ${t} days...`);const r=await this.getAllHealthData(t);return console.log("[HealthKit] Data retrieved, ready for backend sync"),r}catch(r){throw console.error("[HealthKit] Sync failed:",r),r}}}const Ua=d1.getInstance(),sLe=jf("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ja=x.forwardRef(({className:e,variant:t,...r},a)=>n.jsx("div",{ref:a,role:"alert",className:xe(sLe({variant:t}),e),...r}));ja.displayName="Alert";const iLe=x.forwardRef(({className:e,...t},r)=>n.jsx("h5",{ref:r,className:xe("mb-1 font-medium leading-none tracking-tight",e),...t}));iLe.displayName="AlertTitle";const Na=x.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:xe("text-sm [&_p]:leading-relaxed",e),...t}));Na.displayName="AlertDescription";function oLe({onComplete:e,onSkip:t}){const[r,a]=x.useState(!1),[s,i]=x.useState(!0),[o,l]=x.useState(!1),[c,d]=x.useState(!1),[u,h]=x.useState("idle"),[p,f]=x.useState(""),{toast:y}=rt();x.useEffect(()=>{v()},[]);const v=async()=>{if(!Lr()){console.log("[HealthKitOnboarding] Not on native platform, skipping"),l(!1),i(!1);return}console.log("[HealthKitOnboarding] Checking HealthKit availability..."),i(!0),d(!1);try{const j=await Ua.isHealthKitAvailable();console.log("[HealthKitOnboarding] HealthKit available:",j),l(j),i(!1),j||d(!0)}catch(j){console.error("[HealthKitOnboarding] Error checking availability:",j),l(!1),d(!0),i(!1)}},m=async()=>{if(!o){y({title:"Not Available",description:"HealthKit is only available on iOS devices",variant:"destructive"});return}a(!0),h("syncing"),f("");try{if(console.log("[HealthKitOnboarding] Requesting permissions..."),!await Ua.requestPermissions())throw new Error("HealthKit permissions were not granted. You can enable them later in Settings.");console.log("[HealthKitOnboarding] Permissions granted"),console.log("[HealthKitOnboarding] Fetching health data from HealthKit...");const M=await Ua.getAllHealthData(90);console.log("[HealthKitOnboarding] Health data retrieved:",{steps:M.steps.length,hrv:M.hrv.length,sleep:M.sleep.length,workouts:M.workouts.length}),console.log("[HealthKitOnboarding] Sending data to backend..."),await pe("POST","/api/apple-health/sync",M),console.log("[HealthKitOnboarding] Data sent successfully"),h("success"),y({title:"Sync Complete",description:"Your health data has been synced successfully"}),await pe("POST","/api/onboarding/complete-healthkit"),le.invalidateQueries({queryKey:["/api/onboarding/status"]}),le.invalidateQueries({queryKey:["/api/biomarkers"]}),le.invalidateQueries({queryKey:["/api/dashboard/stats"]}),setTimeout(()=>{e()},1500)}catch(j){console.error("HealthKit sync failed:",j),h("error"),f(j.message||"Failed to sync health data"),y({title:"Sync Failed",description:j.message||"Failed to sync health data",variant:"destructive"})}finally{a(!1)}},b=async()=>{try{await pe("POST","/api/onboarding/complete-healthkit"),le.invalidateQueries({queryKey:["/api/onboarding/status"]}),t()}catch(j){console.error("Failed to skip HealthKit setup:",j),t()}},w=x.useRef(!1),[k,N]=x.useState(!1);return x.useEffect(()=>{!s&&!o&&!c&&!w.current&&(w.current=!0,N(!0),console.log("[HealthKitOnboarding] Auto-skipping (not on iOS or plugin unavailable)"),b())},[s,o,c]),s||k?n.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:[n.jsx(nt,{className:"h-8 w-8 animate-spin text-primary mb-4"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:s?"Checking health data availability...":"Setting up your account..."})]}):c&&!o?n.jsx("div",{className:"flex items-center justify-center min-h-screen p-4 bg-background",children:n.jsxs(H,{className:"w-full max-w-2xl",children:[n.jsxs(G,{className:"text-center",children:[n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("div",{className:"p-4 bg-destructive/10 rounded-full",children:n.jsx(Rn,{className:"h-12 w-12 text-destructive"})})}),n.jsx(Y,{className:"text-3xl",children:"Connection Issue"}),n.jsx(je,{className:"text-base mt-2",children:"We couldn't connect to Apple Health. This might be due to a temporary issue."})]}),n.jsxs(B,{className:"space-y-6",children:[n.jsx(ja,{children:n.jsx(Na,{className:"text-sm",children:"You can try again or skip this step and set up Apple Health sync later from the Biomarkers page."})}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs(z,{onClick:()=>v(),size:"lg",className:"w-full","data-testid":"button-retry-healthkit",children:[n.jsx(Or,{className:"h-4 w-4 mr-2"}),"Try Again"]}),n.jsx(z,{onClick:b,variant:"ghost",size:"lg",className:"w-full","data-testid":"button-skip-healthkit",children:"Skip for Now"})]})]})]})}):n.jsx("div",{className:"flex items-center justify-center min-h-screen p-4 bg-background",children:n.jsxs(H,{className:"w-full max-w-2xl",children:[n.jsxs(G,{className:"text-center",children:[n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("div",{className:"p-4 bg-primary/10 rounded-full",children:n.jsx(Or,{className:"h-12 w-12 text-primary"})})}),n.jsx(Y,{className:"text-3xl",children:"Sync Your Health Data"}),n.jsx(je,{className:"text-base mt-2",children:"Connect your Apple Health data to get personalized AI-powered insights"})]}),n.jsxs(B,{className:"space-y-6",children:[n.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[n.jsxs("div",{className:"flex gap-3",children:[n.jsx("div",{className:"mt-1",children:n.jsx(Pt,{className:"h-5 w-5 text-primary"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold",children:"Comprehensive Analysis"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Sync workouts, sleep, heart rate, HRV, and more"})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("div",{className:"mt-1",children:n.jsx(Or,{className:"h-5 w-5 text-primary"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold",children:"Personalized Insights"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Get AI recommendations based on your real health data"})]})]})]}),n.jsx(ja,{children:n.jsx(Na,{className:"text-sm",children:"🔒 Your health data is encrypted and private. We only access data you explicitly grant permission for. You can change permissions anytime in iOS Settings."})}),u==="syncing"&&n.jsxs("div",{className:"flex items-center justify-center gap-3 p-4 bg-primary/5 rounded-lg",children:[n.jsx(nt,{className:"h-5 w-5 animate-spin text-primary"}),n.jsx("span",{className:"text-sm font-medium",children:"Syncing your health data..."})]}),u==="success"&&n.jsxs("div",{className:"flex items-center justify-center gap-3 p-4 bg-green-500/10 rounded-lg",children:[n.jsx(tt,{className:"h-5 w-5 text-green-500"}),n.jsx("span",{className:"text-sm font-medium text-green-500",children:"Sync complete! Loading your dashboard..."})]}),u==="error"&&n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-destructive/10 rounded-lg",children:[n.jsx(Rn,{className:"h-5 w-5 text-destructive"}),n.jsx("span",{className:"text-sm font-medium text-destructive",children:p})]}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsx(z,{onClick:m,disabled:r||u==="success",size:"lg",className:"w-full","data-testid":"button-setup-healthkit",children:r?n.jsxs(n.Fragment,{children:[n.jsx(nt,{className:"h-4 w-4 mr-2 animate-spin"}),"Syncing..."]}):u==="success"?n.jsxs(n.Fragment,{children:[n.jsx(tt,{className:"h-4 w-4 mr-2"}),"Sync Complete"]}):n.jsxs(n.Fragment,{children:[n.jsx(Or,{className:"h-4 w-4 mr-2"}),"Connect Apple Health"]})}),u!=="success"&&n.jsx(z,{onClick:b,disabled:r,variant:"ghost",size:"lg",className:"w-full","data-testid":"button-skip-healthkit",children:"Skip for Now"})]}),n.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"You can sync your health data later from the Biomarkers page"})]})]})})}const lLe={optimal:{badge:"bg-chart-4 text-white",label:"Optimal"},warning:{badge:"bg-chart-5 text-white",label:"Attention"},critical:{badge:"bg-destructive text-destructive-foreground",label:"Critical"}};function cLe({title:e,value:t,unit:r,trend:a,status:s,icon:i,lastUpdated:o,referenceRange:l}){const c=lLe[s],d=a===void 0?Eo:a>0?It:ea,u=a===void 0?"text-muted-foreground":a>0?"text-chart-4":"text-destructive";return n.jsxs(H,{"data-testid":`card-metric-${e.toLowerCase().replace(/\s/g,"-")}`,children:[n.jsxs(G,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[n.jsx(Y,{className:"text-sm font-medium",children:e}),n.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-primary/10",children:n.jsx(i,{className:"h-4 w-4 text-primary"})})]}),n.jsx(B,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-baseline gap-2",children:[n.jsx("span",{className:"text-4xl font-bold tracking-tight","data-testid":`text-value-${e.toLowerCase().replace(/\s/g,"-")}`,children:t}),n.jsx("span",{className:"text-lg text-muted-foreground",children:r})]}),l&&n.jsxs("div",{className:"text-xs text-muted-foreground","data-testid":`text-reference-range-${e.toLowerCase().replace(/\s/g,"-")}`,children:["Reference: ",l.low.toFixed(1),"-",l.high.toFixed(1)," ",r]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[a!==void 0&&n.jsxs("div",{className:`flex items-center gap-1 ${u}`,children:[n.jsx(d,{className:"h-3 w-3"}),n.jsxs("span",{className:"text-xs font-medium",children:[Math.abs(a),"%"]})]}),o&&n.jsx("span",{className:"text-xs text-muted-foreground",children:o})]}),n.jsx(Q,{className:c.badge,"data-testid":`badge-status-${s}`,children:c.label})]})]})})]})}var dLe=Array.isArray,ps=dLe,uLe=typeof Bb=="object"&&Bb&&Bb.Object===Object&&Bb,Z0e=uLe,hLe=Z0e,pLe=typeof self=="object"&&self&&self.Object===Object&&self,mLe=hLe||pLe||Function("return this")(),Qo=mLe,fLe=Qo,yLe=fLe.Symbol,cb=yLe,Yte=cb,Q0e=Object.prototype,gLe=Q0e.hasOwnProperty,xLe=Q0e.toString,Cg=Yte?Yte.toStringTag:void 0;function vLe(e){var t=gLe.call(e,Cg),r=e[Cg];try{e[Cg]=void 0;var a=!0}catch{}var s=xLe.call(e);return a&&(t?e[Cg]=r:delete e[Cg]),s}var bLe=vLe,wLe=Object.prototype,kLe=wLe.toString;function jLe(e){return kLe.call(e)}var NLe=jLe,Xte=cb,SLe=bLe,MLe=NLe,CLe="[object Null]",ALe="[object Undefined]",Zte=Xte?Xte.toStringTag:void 0;function PLe(e){return e==null?e===void 0?ALe:CLe:Zte&&Zte in Object(e)?SLe(e):MLe(e)}var Zl=PLe;function _Le(e){return e!=null&&typeof e=="object"}var Ql=_Le,TLe=Zl,ILe=Ql,LLe="[object Symbol]";function ELe(e){return typeof e=="symbol"||ILe(e)&&TLe(e)==LLe}var H0=ELe,OLe=ps,DLe=H0,RLe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$Le=/^\w*$/;function FLe(e,t){if(OLe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||DLe(e)?!0:$Le.test(e)||!RLe.test(e)||t!=null&&e in Object(t)}var WX=FLe;function zLe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Nd=zLe;const B0=Qt(Nd);var HLe=Zl,BLe=Nd,qLe="[object AsyncFunction]",VLe="[object Function]",ULe="[object GeneratorFunction]",WLe="[object Proxy]";function KLe(e){if(!BLe(e))return!1;var t=HLe(e);return t==VLe||t==ULe||t==qLe||t==WLe}var KX=KLe;const dt=Qt(KX);var GLe=Qo,YLe=GLe["__core-js_shared__"],XLe=YLe,Hq=XLe,Qte=function(){var e=/[^.]+$/.exec(Hq&&Hq.keys&&Hq.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function ZLe(e){return!!Qte&&Qte in e}var QLe=ZLe,JLe=Function.prototype,e9e=JLe.toString;function t9e(e){if(e!=null){try{return e9e.call(e)}catch{}try{return e+""}catch{}}return""}var J0e=t9e,r9e=KX,n9e=QLe,a9e=Nd,s9e=J0e,i9e=/[\\^$.*+?()[\]{}|]/g,o9e=/^\[object .+?Constructor\]$/,l9e=Function.prototype,c9e=Object.prototype,d9e=l9e.toString,u9e=c9e.hasOwnProperty,h9e=RegExp("^"+d9e.call(u9e).replace(i9e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function p9e(e){if(!a9e(e)||n9e(e))return!1;var t=r9e(e)?h9e:o9e;return t.test(s9e(e))}var m9e=p9e;function f9e(e,t){return e==null?void 0:e[t]}var y9e=f9e,g9e=m9e,x9e=y9e;function v9e(e,t){var r=x9e(e,t);return g9e(r)?r:void 0}var Af=v9e,b9e=Af,w9e=b9e(Object,"create"),uH=w9e,Jte=uH;function k9e(){this.__data__=Jte?Jte(null):{},this.size=0}var j9e=k9e;function N9e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var S9e=N9e,M9e=uH,C9e="__lodash_hash_undefined__",A9e=Object.prototype,P9e=A9e.hasOwnProperty;function _9e(e){var t=this.__data__;if(M9e){var r=t[e];return r===C9e?void 0:r}return P9e.call(t,e)?t[e]:void 0}var T9e=_9e,I9e=uH,L9e=Object.prototype,E9e=L9e.hasOwnProperty;function O9e(e){var t=this.__data__;return I9e?t[e]!==void 0:E9e.call(t,e)}var D9e=O9e,R9e=uH,$9e="__lodash_hash_undefined__";function F9e(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=R9e&&t===void 0?$9e:t,this}var z9e=F9e,H9e=j9e,B9e=S9e,q9e=T9e,V9e=D9e,U9e=z9e;function q0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}q0.prototype.clear=H9e;q0.prototype.delete=B9e;q0.prototype.get=q9e;q0.prototype.has=V9e;q0.prototype.set=U9e;var W9e=q0;function K9e(){this.__data__=[],this.size=0}var G9e=K9e;function Y9e(e,t){return e===t||e!==e&&t!==t}var GX=Y9e,X9e=GX;function Z9e(e,t){for(var r=e.length;r--;)if(X9e(e[r][0],t))return r;return-1}var hH=Z9e,Q9e=hH,J9e=Array.prototype,eEe=J9e.splice;function tEe(e){var t=this.__data__,r=Q9e(t,e);if(r<0)return!1;var a=t.length-1;return r==a?t.pop():eEe.call(t,r,1),--this.size,!0}var rEe=tEe,nEe=hH;function aEe(e){var t=this.__data__,r=nEe(t,e);return r<0?void 0:t[r][1]}var sEe=aEe,iEe=hH;function oEe(e){return iEe(this.__data__,e)>-1}var lEe=oEe,cEe=hH;function dEe(e,t){var r=this.__data__,a=cEe(r,e);return a<0?(++this.size,r.push([e,t])):r[a][1]=t,this}var uEe=dEe,hEe=G9e,pEe=rEe,mEe=sEe,fEe=lEe,yEe=uEe;function V0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}V0.prototype.clear=hEe;V0.prototype.delete=pEe;V0.prototype.get=mEe;V0.prototype.has=fEe;V0.prototype.set=yEe;var pH=V0,gEe=Af,xEe=Qo,vEe=gEe(xEe,"Map"),YX=vEe,ere=W9e,bEe=pH,wEe=YX;function kEe(){this.size=0,this.__data__={hash:new ere,map:new(wEe||bEe),string:new ere}}var jEe=kEe;function NEe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var SEe=NEe,MEe=SEe;function CEe(e,t){var r=e.__data__;return MEe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var mH=CEe,AEe=mH;function PEe(e){var t=AEe(this,e).delete(e);return this.size-=t?1:0,t}var _Ee=PEe,TEe=mH;function IEe(e){return TEe(this,e).get(e)}var LEe=IEe,EEe=mH;function OEe(e){return EEe(this,e).has(e)}var DEe=OEe,REe=mH;function $Ee(e,t){var r=REe(this,e),a=r.size;return r.set(e,t),this.size+=r.size==a?0:1,this}var FEe=$Ee,zEe=jEe,HEe=_Ee,BEe=LEe,qEe=DEe,VEe=FEe;function U0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}U0.prototype.clear=zEe;U0.prototype.delete=HEe;U0.prototype.get=BEe;U0.prototype.has=qEe;U0.prototype.set=VEe;var XX=U0,ege=XX,UEe="Expected a function";function ZX(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(UEe);var r=function(){var a=arguments,s=t?t.apply(this,a):a[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,a);return r.cache=i.set(s,o)||i,o};return r.cache=new(ZX.Cache||ege),r}ZX.Cache=ege;var tge=ZX;const WEe=Qt(tge);var KEe=tge,GEe=500;function YEe(e){var t=KEe(e,function(a){return r.size===GEe&&r.clear(),a}),r=t.cache;return t}var XEe=YEe,ZEe=XEe,QEe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,JEe=/\\(\\)?/g,eOe=ZEe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(QEe,function(r,a,s,i){t.push(s?i.replace(JEe,"$1"):a||r)}),t}),tOe=eOe;function rOe(e,t){for(var r=-1,a=e==null?0:e.length,s=Array(a);++r<a;)s[r]=t(e[r],r,e);return s}var QX=rOe,tre=cb,nOe=QX,aOe=ps,sOe=H0,iOe=1/0,rre=tre?tre.prototype:void 0,nre=rre?rre.toString:void 0;function rge(e){if(typeof e=="string")return e;if(aOe(e))return nOe(e,rge)+"";if(sOe(e))return nre?nre.call(e):"";var t=e+"";return t=="0"&&1/e==-iOe?"-0":t}var oOe=rge,lOe=oOe;function cOe(e){return e==null?"":lOe(e)}var nge=cOe,dOe=ps,uOe=WX,hOe=tOe,pOe=nge;function mOe(e,t){return dOe(e)?e:uOe(e,t)?[e]:hOe(pOe(e))}var age=mOe,fOe=H0,yOe=1/0;function gOe(e){if(typeof e=="string"||fOe(e))return e;var t=e+"";return t=="0"&&1/e==-yOe?"-0":t}var fH=gOe,xOe=age,vOe=fH;function bOe(e,t){t=xOe(t,e);for(var r=0,a=t.length;e!=null&&r<a;)e=e[vOe(t[r++])];return r&&r==a?e:void 0}var JX=bOe,wOe=JX;function kOe(e,t,r){var a=e==null?void 0:wOe(e,t);return a===void 0?r:a}var sge=kOe;const Es=Qt(sge);function jOe(e){return e==null}var NOe=jOe;const gt=Qt(NOe);var SOe=Zl,MOe=ps,COe=Ql,AOe="[object String]";function POe(e){return typeof e=="string"||!MOe(e)&&COe(e)&&SOe(e)==AOe}var _Oe=POe;const db=Qt(_Oe);var ige={exports:{}},ar={};/**
jonathanmarsh@Jonathans-MacBook-Air HealthPilot % 
