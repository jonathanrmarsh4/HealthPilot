{
  "problem_summary": "Capacitor plugin builds successfully but shows 'not implemented on ios' at runtime on physical iPhone",
  
  "environment": {
    "platform": "iOS physical device (iPhone)",
    "capacitor_version": "7.4.3",
    "xcode_version": "Latest",
    "cocoapods": "Installed and working",
    "bundle_id": "com.nuvitae.healthpilot"
  },
  
  "symptoms": {
    "build_status": "SUCCESS - App builds and runs without errors",
    "runtime_error": "Plugin check returns: 'HealthPilotHealthKit plugin is not implemented on ios'",
    "healthkit_available": false,
    "other_capacitor_plugins": "All working correctly (StatusBar, Keyboard, SecureStorage, etc.)"
  },
  
  "plugin_structure": {
    "location": "ios/HealthPilotHealthKit/",
    "files": [
      "HealthPilotHealthKit.podspec",
      "Sources/HealthPilotHealthKit.swift (349 lines, @objc class extends CAPPlugin)",
      "Sources/HealthPilotHealthKit.m (CAP_PLUGIN macro registration)"
    ],
    "pod_installation": "Shows in Development Pods in Xcode, podspec validates successfully",
    "framework_embedding": "install_framework script references HealthPilotHealthKit.framework",
    "compilation": "No build errors, framework appears to compile"
  },
  
  "root_cause_hypothesis": "CAP_PLUGIN macro in HealthPilotHealthKit.m never executes because the plugin code is in a separate pod framework that doesn't get force-loaded by the App target. The registration code exists but never runs, so Capacitor's bridge doesn't know the plugin exists.",
  
  "attempted_fixes": [
    "1. Multiple clean builds and pod reinstalls",
    "2. Removing and re-adding .m file",
    "3. Adding 'import HealthPilotHealthKit' to CapacitorPlugins.swift (caused module conflict)",
    "4. Adding OTHER_LDFLAGS '-framework HealthPilotHealthKit' in Podfile post_install",
    "5. Removing assertDeploymentTarget from Podfile",
    "6. Verifying .m file has correct CAP_PLUGIN macro syntax",
    "7. Checking pod is in Development Pods folder in Xcode",
    "All fixes resulted in same runtime error: 'not implemented on ios'"
  ],
  
  "key_observations": {
    "no_pods_directory": "Pods/HealthPilotHealthKit directory doesn't exist (expected for development pods - they use symlinks)",
    "development_pod": "Plugin shows in Xcode under Development Pods, not regular Pods",
    "registration_mechanism": "Capacitor 7+ auto-registers via CAP_PLUGIN macro in .m files",
    "working_example": "Other Capacitor plugins using same CAP_PLUGIN pattern work fine"
  },
  
  "expert_recommendation": "Move plugin files directly into ios/App/App target instead of separate pod, similar to how some projects embed custom plugins directly in the app binary to ensure CAP_PLUGIN registration executes",
  
  "data_requirements": "Plugin must support 27 HealthKit data types (vs 8 in Capgo Health plugin): steps, distance, calories, heart rate, HRV, blood pressure, oxygen saturation, sleep, workouts, weight, BMI, body fat, glucose, nutrition, etc.",
  
  "time_invested": "4 days of debugging with circular attempts",
  
  "files_attached": [
    "HealthPilotHealthKit.podspec",
    "HealthPilotHealthKit.swift", 
    "HealthPilotHealthKit.m",
    "Podfile",
    "healthkit.ts (client service)"
  ]
}